<!-- pageheader and progress -->
<app-page-header title="System Cloud">
    <div class="prog-contain d-flex align-items-center gap-5">
        <div class="storage d-flex flex-column">
            <p>Storage</p>
            <span>1.4 GB free / 2.0 GB</span>
        </div>
        <div class="progress" style="height: 32px; width: 165px;">
            <div class="progress-bar" role="progressbar" style="width: 75%;" aria-valuenow="75" aria-valuemin="0"
                aria-valuemax="100"></div>
        </div>
    </div>
</app-page-header>


<div class="content-hug">
    <!-- templates -->
    <div class="content-box p-0 d-flex flex-column">
        <div class="head-box">
            <a type="button" (click)="toggleCollapse()">
                <svg *ngIf="isExpanded" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="1.5" d="m19 15l-7-6l-7 6" />
                </svg>
                <svg *ngIf="!isExpanded" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="1.5" d="m19 9l-7 6l-7-6" />
                </svg>
                <span>Templates</span>
            </a>
            <div class="d-flex align-items-center gap-3 justify-content-end w-50" *ngIf="isExpanded">
                <!-- <div class="form-outline position-relative w-50">
                    <select name="" id="status" class="form-select">
                        <option value="" class="place" selected disabled hidden>Select</option>
                        <option value="all">Any</option>
                        <option value="true">Active</option>
                        <option value="false">Not Active</option>
                    </select>
                </div> -->
                <div data-mdb-input-init class="form-outline w-50">
                    <input type="text" class="form-control" placeholder="Search for a Template" [(ngModel)]="searchText"
                        (input)="filterTemplates()" />
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                        <g fill="none" stroke-width="1.5">
                            <circle cx="11.5" cy="11.5" r="9.5" />
                            <path stroke-linecap="round" d="M18.5 18.5L22 22" />
                        </g>
                    </svg>
                </div>


            </div>
        </div>

        <div class="content-files" *ngIf="isExpanded">
            <div class="d-flex justify-content-center align-items-center" style="min-height: 150px;"
                *ngIf="!isAllLoaded">
                <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status">
                </div>
            </div>
            <div class="row g-3" *ngIf="isAllLoaded">
                <div class="col-12 text-center empty"
                    *ngIf="isAllLoaded && systemTemplates.length > 0 && filteredTemplates.length === 0 && searchText">
                    <img src="./images/emptyfolder.svg" />
                    <p>No matching Templates</p>
                </div>

                <div class="col-6 col-md-3 col-lg-2" *ngFor="let temp of filteredTemplates">
                    <div tabindex="0" class="file template">
                        <svg width="114" height="114" viewBox="0 0 116 116" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M0.600098 97.5995C0.600098 99.1378 1.21117 100.613 2.29888 101.701C3.38659 102.788 4.86184 103.4 6.4001 103.4H14.1334V89.8662H4.46676C4.46676 89.8662 0.600098 89.8662 0.600098 97.5995Z"
                                fill="#2C435D" />
                            <path
                                d="M93.4002 22.1998V105.333C93.4002 107.384 92.5854 109.351 91.1352 110.801C89.6849 112.252 87.7179 113.066 85.6669 113.066H19.9335C17.8825 113.066 15.9155 112.252 14.4652 110.801C13.015 109.351 12.2002 107.384 12.2002 105.333V8.66644C12.2002 6.61543 13.015 4.64843 14.4652 3.19815C15.9155 1.74787 17.8825 0.933105 19.9335 0.933105H72.1335L93.4002 22.1998Z"
                                fill="#DDE3EB" />
                            <path
                                d="M93.4002 22.1998H74.0669C73.0035 22.1998 72.1335 21.3298 72.1335 20.2664V0.933105L93.4002 22.1998Z"
                                fill="#93A7C1" />
                            <path
                                d="M6.4001 91.8H46.6421C48.1803 91.8 49.6556 91.1889 50.7433 90.1012C51.831 89.0135 52.4421 87.5382 52.4421 86V58.9333C52.4421 57.395 51.831 55.9198 50.7433 54.8321C49.6556 53.7444 48.1803 53.1333 46.6421 53.1333H6.4001C4.86184 53.1333 3.38659 53.7444 2.29888 54.8321C1.21117 55.9198 0.600098 57.395 0.600098 58.9333V97.6C0.600098 96.0617 1.21117 94.5865 2.29888 93.4988C3.38659 92.411 4.86184 91.8 6.4001 91.8Z"
                                fill="#4A6D97" />

                            <!-- employee icon -->
                            <g transform="translate(10,53) scale(1.5)" *ngIf="temp.type==='employee_sheet'">
                                <path fill="#ffffff" fill-rule="evenodd"
                                    d="M9 6.25a2.75 2.75 0 1 0 0 5.5a2.75 2.75 0 0 0 0-5.5M7.75 9a1.25 1.25 0 1 1 2.5 0a1.25 1.25 0 0 1-2.5 0M9 12.25c-1.196 0-2.315.24-3.164.665c-.803.402-1.586 1.096-1.586 2.085v.063c-.002.51-.004 1.37.81 1.959c.378.273.877.448 1.495.559c.623.112 1.422.169 2.445.169s1.822-.057 2.445-.169c.618-.111 1.117-.286 1.495-.56c.814-.589.812-1.448.81-1.959V15c0-.99-.783-1.683-1.586-2.085c-.849-.424-1.968-.665-3.164-.665M5.75 15c0-.115.113-.421.757-.743c.6-.3 1.48-.507 2.493-.507s1.894.207 2.493.507c.644.322.757.628.757.743c0 .604-.039.697-.19.807c-.122.088-.373.206-.88.298c-.502.09-1.203.145-2.18.145s-1.678-.055-2.18-.145c-.507-.092-.758-.21-.88-.298c-.152-.11-.19-.203-.19-.807"
                                    clip-rule="evenodd" />
                                <path fill="#ffffff"
                                    d="M19 12.75a.75.75 0 0 0 0-1.5h-4a.75.75 0 0 0 0 1.5zM19.75 9a.75.75 0 0 1-.75.75h-5a.75.75 0 0 1 0-1.5h5a.75.75 0 0 1 .75.75M19 15.75a.75.75 0 0 0 0-1.5h-3a.75.75 0 0 0 0 1.5z" />
                                <path fill="#ffffff" fill-rule="evenodd"
                                    d="M9.944 3.25h4.112c1.838 0 3.294 0 4.433.153c1.172.158 2.121.49 2.87 1.238c.748.749 1.08 1.698 1.238 2.87c.153 1.14.153 2.595.153 4.433v.112c0 1.838 0 3.294-.153 4.433c-.158 1.172-.49 2.121-1.238 2.87c-.749.748-1.698 1.08-2.87 1.238c-1.14.153-2.595.153-4.433.153H9.945c-1.838 0-3.294 0-4.433-.153c-1.172-.158-2.121-.49-2.87-1.238c-.748-.749-1.08-1.698-1.238-2.87c-.153-1.14-.153-2.595-.153-4.433v-.112c0-1.838 0-3.294.153-4.433c.158-1.172.49-2.121 1.238-2.87c.749-.748 1.698-1.08 2.87-1.238c1.14-.153 2.595-.153 4.433-.153M5.71 4.89c-1.006.135-1.586.389-2.01.812c-.422.423-.676 1.003-.811 2.009c-.138 1.028-.14 2.382-.14 4.289s.002 3.262.14 4.29c.135 1.005.389 1.585.812 2.008s1.003.677 2.009.812c1.028.138 2.382.14 4.289.14h4c1.907 0 3.262-.002 4.29-.14c1.005-.135 1.585-.389 2.008-.812s.677-1.003.812-2.009c.138-1.028.14-2.382.14-4.289s-.002-3.261-.14-4.29c-.135-1.005-.389-1.585-.812-2.008s-1.003-.677-2.009-.812c-1.027-.138-2.382-.14-4.289-.14h-4c-1.907 0-3.261.002-4.29.14"
                                    clip-rule="evenodd" />
                            </g>

                            <!-- department icon -->
                            <g transform="translate(15,57) scale(1.2)" *ngIf="temp.type==='department_sheet'">
                                <path fill="#ffffff" fill-rule="evenodd"
                                    d="M5.948 1.75c-.898 0-1.648 0-2.242.08c-.628.084-1.195.27-1.65.725c-.456.456-.642 1.023-.726 1.65c-.08.595-.08 1.345-.08 2.243v2.104c0 .898 0 1.648.08 2.242c.084.628.27 1.195.725 1.65c.456.456 1.023.642 1.65.726c.595.08 1.345.08 2.243.08h.104c.898 0 1.648 0 2.242-.08c.628-.084 1.195-.27 1.65-.726c.456-.455.642-1.022.726-1.65c.08-.594.08-1.344.08-2.242V6.448c0-.898 0-1.648-.08-2.242c-.084-.628-.27-1.195-.725-1.65c-.456-.456-1.023-.642-1.65-.726c-.595-.08-1.344-.08-2.243-.08zM3.116 3.616c.13-.13.328-.237.79-.3c.482-.064 1.13-.066 2.094-.066s1.612.002 2.095.067c.461.062.659.169.789.3s.237.327.3.788c.064.483.066 1.131.066 2.095v2c0 .964-.002 1.612-.067 2.095c-.062.461-.169.659-.3.789s-.327.237-.788.3c-.483.064-1.131.066-2.095.066s-1.612-.002-2.095-.066c-.461-.063-.659-.17-.789-.3s-.237-.328-.3-.79c-.064-.482-.066-1.13-.066-2.094v-2c0-.964.002-1.612.067-2.095c.062-.461.169-.659.3-.789m14.331 7.134c-.899 0-1.648 0-2.242.08c-.628.084-1.195.27-1.65.726c-.456.455-.642 1.022-.726 1.65c-.08.594-.08 1.344-.08 2.242v2.104c0 .899 0 1.648.08 2.242c.084.628.27 1.195.726 1.65c.455.456 1.022.642 1.65.726c.594.08 1.343.08 2.242.08h.104c.898 0 1.648 0 2.242-.08c.628-.084 1.195-.27 1.65-.726c.456-.455.642-1.022.726-1.65c.08-.594.08-1.343.08-2.242v-2.104c0-.898 0-1.648-.08-2.242c-.084-.628-.27-1.195-.726-1.65c-.455-.456-1.022-.642-1.65-.726c-.594-.08-1.343-.08-2.242-.08zm-2.832 1.866c.13-.13.328-.237.79-.3c.482-.064 1.13-.066 2.094-.066s1.612.002 2.095.066c.461.063.659.17.789.3s.237.328.3.79c.064.482.066 1.13.066 2.094v2c0 .964-.002 1.612-.067 2.095c-.062.461-.169.659-.3.789s-.327.237-.788.3c-.483.064-1.131.066-2.095.066s-1.612-.002-2.095-.067c-.461-.062-.659-.169-.789-.3s-.237-.327-.3-.788c-.064-.483-.066-1.131-.066-2.095v-2c0-.964.002-1.612.066-2.095c.063-.461.17-.659.3-.789M16.475 1.75h2.05c.445 0 .816 0 1.12.02c.317.022.617.07.907.19a2.75 2.75 0 0 1 1.489 1.488c.12.29.167.59.188.907c.021.304.021.675.021 1.12v.05c0 .445 0 .816-.02 1.12a2.8 2.8 0 0 1-.19.907a2.75 2.75 0 0 1-1.488 1.489c-.29.12-.59.167-.907.188c-.304.021-.675.021-1.12.021h-2.05c-.445 0-.816 0-1.12-.02a2.8 2.8 0 0 1-.907-.19a2.75 2.75 0 0 1-1.489-1.488c-.12-.29-.167-.59-.188-.907c-.021-.304-.021-.675-.021-1.12v-.05c0-.445 0-.816.02-1.12a2.8 2.8 0 0 1 .19-.907a2.75 2.75 0 0 1 1.488-1.489c.29-.12.59-.167.907-.188c.304-.021.675-.021 1.12-.021m-1.018 1.517c-.241.017-.358.046-.435.078a1.25 1.25 0 0 0-.677.677c-.032.077-.061.194-.078.435A17 17 0 0 0 14.25 5.5c0 .476 0 .796.017 1.043c.017.241.046.358.078.435c.127.307.37.55.677.677c.077.032.194.061.435.078c.247.017.567.017 1.043.017h2c.476 0 .796 0 1.043-.017c.241-.017.358-.046.435-.078c.307-.127.55-.37.677-.677c.032-.077.061-.194.078-.435c.017-.247.017-.567.017-1.043s0-.796-.017-1.043c-.017-.241-.046-.358-.078-.435a1.25 1.25 0 0 0-.677-.677c-.077-.032-.194-.061-.435-.078A17 17 0 0 0 18.5 3.25h-2c-.476 0-.796 0-1.043.017M4.975 14.75c-.445 0-.816 0-1.12.02a2.8 2.8 0 0 0-.907.19a2.75 2.75 0 0 0-1.489 1.488c-.12.29-.167.59-.188.907c-.021.304-.021.675-.021 1.12v.05c0 .445 0 .816.02 1.12c.022.317.07.617.19.907a2.75 2.75 0 0 0 1.488 1.489c.29.12.59.167.907.188c.304.021.675.021 1.12.021h2.05c.445 0 .816 0 1.12-.02c.317-.022.617-.069.907-.19a2.75 2.75 0 0 0 1.489-1.488c.12-.29.167-.59.188-.907c.021-.304.021-.675.021-1.12v-.05c0-.445 0-.816-.02-1.12a2.8 2.8 0 0 0-.19-.907a2.75 2.75 0 0 0-1.488-1.489c-.29-.12-.59-.167-.907-.188c-.304-.021-.675-.021-1.12-.021zm-1.453 1.595c.077-.032.194-.061.435-.078A17 17 0 0 1 5 16.25h2c.476 0 .796 0 1.043.017c.241.017.358.046.435.078c.307.127.55.37.677.677c.032.077.061.194.078.435c.017.247.017.567.017 1.043s0 .796-.017 1.043c-.017.241-.046.358-.078.435a1.25 1.25 0 0 1-.677.677c-.077.032-.194.061-.435.078A17 17 0 0 1 7 20.75H5c-.476 0-.796 0-1.043-.017c-.241-.017-.358-.046-.435-.078a1.25 1.25 0 0 1-.677-.677c-.032-.077-.061-.194-.078-.435A17 17 0 0 1 2.75 18.5c0-.476 0-.796.017-1.043c.017-.241.046-.358.078-.435c.127-.307.37-.55.677-.677"
                                    clip-rule="evenodd" />
                            </g>

                            <!-- department icon -->
                            <g transform="translate(15,58) scale(1.1)" *ngIf="temp.type==='branch_sheet'">
                                <path fill="#ffffff" fill-rule="evenodd" clip-rule="evenodd"
                                    d="M3.69231 7.94762C3.69231 3.51422 7.45693 0 12 0C16.4406 0 20.1374 3.35741 20.302 7.64892L20.89 7.84515C21.46 8.03532 21.9596 8.202 22.3559 8.38659C22.7844 8.58614 23.1771 8.84317 23.4773 9.26013C23.7775 9.67709 23.8969 10.1313 23.9505 10.6013C24.0001 11.0361 24 11.5633 24 12.1648V19.2473C24 19.9982 24.0001 20.6388 23.9419 21.1527C23.8806 21.6933 23.7437 22.2245 23.3728 22.6777C23.1598 22.938 22.9013 23.1573 22.6098 23.3248C22.1023 23.6166 21.5563 23.6644 21.0136 23.636C20.4977 23.609 19.8665 23.5037 19.1267 23.3802L19.0755 23.3717C17.4843 23.1062 16.8432 23.0058 16.2183 23.0582C15.9897 23.0773 15.7626 23.1115 15.5385 23.1605C14.926 23.2944 14.337 23.5819 12.8813 24.3106C12.8307 24.3359 12.7806 24.361 12.7311 24.3858C11.0294 25.2379 9.98095 25.7629 8.84961 25.9269C8.50934 25.9762 8.16593 26.0006 7.8221 26C6.679 25.9978 5.57532 25.6293 3.78505 25.0316C3.73327 25.0143 3.68091 24.9968 3.62796 24.9792L3.15588 24.8216L3.10995 24.8063C2.53998 24.6161 2.0404 24.4495 1.64406 24.2649C1.21558 24.0653 0.82291 23.8083 0.522718 23.3913C0.222526 22.9744 0.103125 22.5202 0.049521 22.0501C-6.43042e-05 21.6153 -3.33454e-05 21.0881 1.86719e-06 20.4867L2.16063e-06 14.3016C-3.57663e-05 13.333 -6.77475e-05 12.5166 0.0828193 11.8771C0.169336 11.2096 0.364951 10.557 0.901691 10.0663C1.05947 9.92199 1.2334 9.79649 1.42 9.69227C2.05481 9.3377 2.73509 9.35829 3.39497 9.48719C3.52883 9.51334 3.66904 9.54554 3.81562 9.58294C3.73429 9.03361 3.69231 8.48597 3.69231 7.94762ZM4.30609 11.6551C3.77935 11.485 3.37507 11.3664 3.04139 11.3012C2.55506 11.2062 2.39564 11.2637 2.31949 11.3063C2.25729 11.341 2.19931 11.3828 2.14672 11.4309C2.08234 11.4898 1.97739 11.623 1.91362 12.1149C1.84801 12.6211 1.84616 13.3162 1.84616 14.3642V20.4382C1.84616 21.1024 1.84755 21.523 1.88376 21.8405C1.91727 22.1344 1.97211 22.2436 2.0204 22.3107C2.06868 22.3777 2.15487 22.4644 2.42276 22.5891C2.71218 22.7239 3.11026 22.8582 3.73968 23.0683L4.21176 23.2258C6.21 23.8926 7.01648 24.1503 7.8256 24.1518C8.07972 24.1523 8.33355 24.1342 8.58506 24.0978C9.38563 23.9817 10.155 23.6089 12.0556 22.6575C12.0941 22.6382 12.1322 22.6192 12.1698 22.6003C13.4753 21.9467 14.2794 21.544 15.1446 21.3549C15.4478 21.2886 15.7551 21.2423 16.0644 21.2164C16.9468 21.1425 17.8269 21.2895 19.2548 21.5279C19.2957 21.5347 19.3371 21.5416 19.379 21.5486C20.1842 21.683 20.7112 21.7695 21.1101 21.7904C21.4939 21.8105 21.6259 21.7592 21.6904 21.7221C21.7876 21.6662 21.8738 21.5932 21.9448 21.5064C21.992 21.4487 22.0642 21.3269 22.1075 20.9445C22.1525 20.5472 22.1538 20.0126 22.1538 19.1954V12.2132C22.1538 11.549 22.1525 11.1285 22.1162 10.811C22.0827 10.5171 22.0279 10.4079 21.9796 10.3408C21.9313 10.2737 21.8451 10.1871 21.5772 10.0623C21.2878 9.92755 20.8897 9.79323 20.2603 9.58319L20.1879 9.55903C19.9538 11.1625 19.3841 12.7813 18.5443 14.2261C17.4213 16.1582 15.7781 17.8411 13.7195 18.7402C12.6269 19.2173 11.3731 19.2173 10.2805 18.7402C8.22187 17.8411 6.5787 16.1582 5.45567 14.2261C4.98303 13.413 4.59594 12.5447 4.30609 11.6551ZM12 1.8482C8.38625 1.8482 5.53846 4.62305 5.53846 7.94762C5.53846 9.6941 6.07685 11.62 7.05134 13.2966C8.0261 14.9736 9.40003 16.3392 11.0187 17.0461C11.6406 17.3177 12.3594 17.3177 12.9813 17.0461C14.6 16.3392 15.9739 14.9736 16.9487 13.2966C17.9232 11.62 18.4615 9.6941 18.4615 7.94762C18.4615 4.62305 15.6137 1.8482 12 1.8482ZM12 6.77672C11.1503 6.77672 10.4615 7.46627 10.4615 8.31688C10.4615 9.16749 11.1503 9.85705 12 9.85705C12.8497 9.85705 13.5385 9.16749 13.5385 8.31688C13.5385 7.46627 12.8497 6.77672 12 6.77672ZM8.61539 8.31688C8.61539 6.44554 10.1307 4.92852 12 4.92852C13.8693 4.92852 15.3846 6.44554 15.3846 8.31688C15.3846 10.1882 13.8693 11.7052 12 11.7052C10.1307 11.7052 8.61539 10.1882 8.61539 8.31688Z" />
                            </g>

                        </svg>


                        <h6>{{temp.label}}</h6>
                        <button class="btn btn-primary w-auto" (click)="openModalNewFile()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                                <g fill="none" stroke="currentColor" stroke-width="1.5">
                                    <circle cx="12" cy="12" r="10" />
                                    <path stroke-linecap="round" d="M15 12h-3m0 0H9m3 0V9m0 3v3" />
                                </g>
                            </svg>
                            <span>New File</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Drive -->
    <div class="content-box p-0 d-flex flex-column mt-4" (dragover)="onDragOver($event)" (drop)="onDrop($event)"
        (dragleave)="onDragLeave($event)" [class.dragover-active]="isDragOver">
        <div class="head-box">
            <nav class="m-0" style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item" *ngFor="let crumb of breadcrumb; let i = index"
                        [ngClass]="{'active': crumb.id === openedFolderId}" (click)="goToFolder(crumb.id)"
                        style="cursor: pointer">
                        <a>{{ crumb.name }}</a>
                    </li>
                </ol>
            </nav>


            <div class="d-flex align-items-center gap-3 justify-content-end w-50">
                <div data-mdb-input-init class="form-outline w-50">
                    <input type="text" class="form-control" placeholder="Search in this folder"
                        [(ngModel)]="searchFolderText" (input)="filterFolders()" />
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                        <g fill="none" stroke-width="1.5">
                            <circle cx="11.5" cy="11.5" r="9.5" />
                            <path stroke-linecap="round" d="M18.5 18.5L22 22" />
                        </g>
                    </svg>
                </div>

                <div class="switchs d-flex">
                    <a type="button" class="dispaly-switch" [class.active]="selectedView === 'grid'"
                        (click)="setView('grid')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                            <path fill="currentColor" fill-rule="evenodd"
                                d="M6.448 1.75c-.898 0-1.648 0-2.242.08c-.628.084-1.195.27-1.65.725c-.456.456-.642 1.023-.726 1.65c-.08.595-.08 1.345-.08 2.243v.104c0 .898 0 1.648.08 2.242c.084.628.27 1.195.725 1.65c.456.456 1.023.642 1.65.726c.595.08 1.345.08 2.243.08h.104c.898 0 1.648 0 2.242-.08c.628-.084 1.195-.27 1.65-.726c.456-.455.642-1.022.726-1.65c.08-.594.08-1.344.08-2.242v-.104c0-.898 0-1.648-.08-2.242c-.084-.628-.27-1.195-.726-1.65c-.455-.456-1.022-.642-1.65-.726c-.594-.08-1.344-.08-2.242-.08zM3.616 3.616c.13-.13.328-.237.79-.3c.482-.064 1.13-.066 2.094-.066s1.612.002 2.095.067c.461.062.659.169.789.3s.237.327.3.788c.064.483.066 1.131.066 2.095s-.002 1.612-.067 2.095c-.062.461-.169.659-.3.789s-.327.237-.788.3c-.483.064-1.131.066-2.095.066s-1.612-.002-2.095-.067c-.461-.062-.659-.169-.789-.3s-.237-.327-.3-.788C3.253 8.112 3.25 7.464 3.25 6.5s.002-1.612.067-2.095c.062-.461.169-.659.3-.789m13.831 9.134c-.899 0-1.648 0-2.242.08c-.628.084-1.195.27-1.65.726c-.456.455-.642 1.022-.726 1.65c-.08.594-.08 1.343-.08 2.242v.104c0 .899 0 1.648.08 2.242c.084.628.27 1.195.726 1.65c.455.456 1.022.642 1.65.726c.594.08 1.343.08 2.242.08h.104c.898 0 1.648 0 2.242-.08c.628-.084 1.195-.27 1.65-.726c.456-.455.642-1.022.726-1.65c.08-.594.08-1.343.08-2.242v-.104c0-.898 0-1.648-.08-2.242c-.084-.628-.27-1.195-.726-1.65c-.455-.456-1.022-.642-1.65-.726c-.594-.08-1.343-.08-2.242-.08zm-2.832 1.866c.13-.13.328-.237.79-.3c.482-.064 1.13-.066 2.094-.066s1.612.002 2.095.066c.461.063.659.17.789.3s.237.328.3.79c.064.482.066 1.13.066 2.094s-.002 1.612-.067 2.095c-.062.461-.169.659-.3.789s-.327.237-.788.3c-.483.064-1.131.066-2.095.066s-1.612-.002-2.095-.067c-.461-.062-.659-.169-.789-.3s-.237-.327-.3-.788c-.064-.483-.066-1.131-.066-2.095s.002-1.612.066-2.095c.063-.461.17-.659.3-.789M6.448 12.75h.104c.898 0 1.648 0 2.242.08c.628.084 1.195.27 1.65.726c.456.455.642 1.022.726 1.65c.08.594.08 1.343.08 2.242v.104c0 .899 0 1.648-.08 2.242c-.084.628-.27 1.195-.726 1.65c-.455.456-1.022.642-1.65.726c-.594.08-1.343.08-2.242.08h-.104c-.898 0-1.648 0-2.242-.08c-.628-.084-1.195-.27-1.65-.726c-.456-.455-.642-1.022-.726-1.65c-.08-.594-.08-1.343-.08-2.242v-.104c0-.899 0-1.648.08-2.242c.084-.628.27-1.195.725-1.65c.456-.456 1.023-.642 1.65-.726c.595-.08 1.345-.08 2.243-.08m-2.043 1.566c-.461.063-.659.17-.789.3s-.237.328-.3.79c-.064.482-.066 1.13-.066 2.094s.002 1.612.067 2.095c.062.461.169.659.3.789s.327.237.788.3c.483.064 1.131.066 2.095.066s1.612-.002 2.095-.067c.461-.062.659-.169.789-.3s.237-.327.3-.788c.064-.483.066-1.131.066-2.095s-.002-1.612-.067-2.095c-.062-.461-.169-.659-.3-.789s-.327-.237-.788-.3c-.483-.064-1.131-.066-2.095-.066s-1.612.002-2.095.066M17.448 1.75c-.899 0-1.648 0-2.242.08c-.628.084-1.195.27-1.65.725c-.456.456-.642 1.023-.726 1.65c-.08.595-.08 1.345-.08 2.243v.104c0 .898 0 1.648.08 2.242c.084.628.27 1.195.726 1.65c.455.456 1.022.642 1.65.726c.594.08 1.343.08 2.242.08h.104c.899 0 1.648 0 2.242-.08c.628-.084 1.195-.27 1.65-.726c.456-.455.642-1.022.726-1.65c.08-.594.08-1.344.08-2.242v-.104c0-.898 0-1.648-.08-2.242c-.084-.628-.27-1.195-.726-1.65c-.455-.456-1.022-.642-1.65-.726c-.594-.08-1.343-.08-2.242-.08zm-2.832 1.866c.13-.13.328-.237.79-.3c.482-.064 1.13-.066 2.094-.066s1.612.002 2.095.067c.461.062.659.169.789.3s.237.327.3.788c.064.483.066 1.131.066 2.095s-.002 1.612-.067 2.095c-.062.461-.169.659-.3.789s-.327.237-.788.3c-.483.064-1.131.066-2.095.066s-1.612-.002-2.095-.067c-.461-.062-.659-.169-.789-.3s-.237-.327-.3-.788c-.064-.483-.066-1.131-.066-2.095s.002-1.612.066-2.095c.063-.461.17-.659.3-.789"
                                clip-rule="evenodd" />
                        </svg>
                        <span>Grid</span>
                    </a>
                    <a type="button" class="dispaly-switch" [class.active]="selectedView === 'list'"
                        (click)="setView('list')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                            <path fill="currentColor" fill-rule="evenodd"
                                d="M3.25 7A.75.75 0 0 1 4 6.25h16a.75.75 0 0 1 0 1.5H4A.75.75 0 0 1 3.25 7m0 5a.75.75 0 0 1 .75-.75h11a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.75-.75m0 5a.75.75 0 0 1 .75-.75h5a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.75-.75"
                                clip-rule="evenodd" />
                        </svg>
                        <span>List</span>
                    </a>
                </div>



            </div>
        </div>


        <div class="content-files position-relative">
            <div class="d-flex justify-content-center align-items-center" style="min-height: 150px;"
                *ngIf="!isAllLoaded">
                <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status">
                </div>
            </div>
            <!-- grid -->
            <div class="row g-3" *ngIf="selectedView === 'grid' && isAllLoaded">
                <div class="col-12 text-center empty" *ngIf="isAllLoaded && files.length === 0 && !searchFolderText">
                    <img src="./images/emptyfolder.svg" />
                    <p>This Folder is Empty</p>
                </div>

                <div class="col-12 text-center empty"
                    *ngIf="isAllLoaded && files.length > 0 && filteredFiles.length === 0 && searchFolderText">
                    <img src="./images/emptyfolder.svg" />
                    <p>No matching files or folders</p>
                </div>
                <div class="col-6 col-md-3 col-lg-2" *ngFor="let folder of filteredFiles">
                    <!-- folder -->
                    <div tabindex="0" class="file" *ngIf="folder.type==='Folder'" (dblclick)="openFolder(folder)">
                        <svg width="116" height="106" viewBox="0 0 116 106" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path class="st3"
                                d="M41.0946 0.251465C42.9525 0.251465 44.7339 0.989273 46.0479 2.30332L58 14.2554H108.998C112.865 14.2554 116 17.3904 116 21.2578V35.2618H101.996V30.5926L87.9921 49.2657H0V7.25389C0 3.38645 3.13498 0.251465 7.00243 0.251465H41.0946Z" />
                            <path class="st1"
                                d="M108.998 28.2593C112.865 28.2593 116 31.3943 116 35.2617V98.7467C116 102.614 112.865 105.748 108.998 105.748H7.00243C3.1351 105.748 0.000186812 102.614 0 98.7467V49.2656C0 45.3982 3.13498 42.2632 7.00243 42.2632H58L69.9521 30.3111C70.6024 29.6606 71.3752 29.1448 72.225 28.7928C73.0748 28.4408 73.9856 28.2592 74.9054 28.2593H108.998Z" />
                        </svg>

                        <h6>{{folder.name}}</h6>
                    </div>

                    <!-- file -->
                    <div tabindex="0" class="file" *ngIf="folder.type==='File'">
                        <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 116 116" width="114" height="114"
                            xml:space="preserve">
                            <path class="st0"
                                d="M11.6,98.6c0,1.5,0.6,3,1.7,4.1c1.1,1.1,2.6,1.7,4.1,1.7h7.7V90.9h-9.7C15.5,90.9,11.6,90.9,11.6,98.6z" />
                            <path class="st1" d="M104.4,23.2v83.1c0,2.1-0.8,4-2.3,5.5c-1.5,1.5-3.4,2.3-5.5,2.3H30.9c-2.1,0-4-0.8-5.5-2.3
        c-1.5-1.5-2.3-3.4-2.3-5.5V9.7c0-2.1,0.8-4,2.3-5.5c1.5-1.5,3.4-2.3,5.5-2.3h52.2L104.4,23.2z" />
                            <path class="st2" d="M104.4,23.2H85.1c-1.1,0-1.9-0.9-1.9-1.9V1.9L104.4,23.2z" />
                            <path class="st3" d="M17.4,92.8H87c1.5,0,3-0.6,4.1-1.7c1.1-1.1,1.7-2.6,1.7-4.1V59.9c0-1.5-0.6-3-1.7-4.1s-2.6-1.7-4.1-1.7H17.4
        c-1.5,0-3,0.6-4.1,1.7s-1.7,2.6-1.7,4.1v38.7c0-1.5,0.6-3,1.7-4.1C14.4,93.4,15.9,92.8,17.4,92.8z" />

                            <text [attr.x]="getTextX(folder.file_type)" y="84" class="label capitalize"> {{
                                getFileTypeText(folder.file_type) }}</text>
                        </svg>
                       <h6>{{ getCleanName(folder.name) }}</h6>


                    </div>
                </div>

                <div class="col-6 col-md-3 col-lg-2">
                    <div *ngIf="isLoading" class="d-flex justify-content-center align-items-center"
                        style="height: 100%;">
                        <div class="position-relative d-inline-block">
                            <svg class="progress-circle" viewBox="0 0 36 36">
                                <path class="circle-bg" d="M18 2.0845
             a 15.9155 15.9155 0 0 1 0 31.831
             a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <path class="circle" [attr.stroke-dasharray]="uploadProgress + ', 100'" d="M18 2.0845
             a 15.9155 15.9155 0 0 1 0 31.831
             a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <text x="50%" y="50%" class="percentage">{{ uploadProgress }}%</text>
                            </svg>
                        </div>
                    </div>
                </div>


            </div>


            <!-- list -->
            <table class="w-100" *ngIf="selectedView === 'list' && isAllLoaded">
                <thead>
                    <tr>
                        <td class="table-icon"></td>
                        <td class="w-50"></td>
                        <td>Total Files</td>
                        <td>Size</td>
                        <td>Last Edited</td>
                        <td>Created</td>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngIf="isAllLoaded && files.length === 0 && !searchFolderText">
                        <td colspan="6" class="text-center empty">
                            <img src="./images/emptyfolder.svg" />
                            <p>This Folder is Empty</p>
                        </td>
                    </tr>

                    <tr *ngIf="isAllLoaded && files.length > 0 && filteredFiles.length === 0 && searchFolderText">
                        <td colspan="6" class="text-center empty">
                            <img src="./images/emptyfolder.svg" />
                            <p>No matching files or folders</p>
                        </td>
                    </tr>

                    <tr class="table-file cursor-pointer" *ngFor="let folder of filteredFiles"
                        (dblclick)="openFolder(folder)">
                        <td>
                            <svg width="35" height="35" viewBox="0 0 116 106" fill="none" *ngIf="folder.type==='Folder'"
                                xmlns="http://www.w3.org/2000/svg">
                                <path class="st3"
                                    d="M41.0946 0.251465C42.9525 0.251465 44.7339 0.989273 46.0479 2.30332L58 14.2554H108.998C112.865 14.2554 116 17.3904 116 21.2578V35.2618H101.996V30.5926L87.9921 49.2657H0V7.25389C0 3.38645 3.13498 0.251465 7.00243 0.251465H41.0946Z" />
                                <path class="st1"
                                    d="M108.998 28.2593C112.865 28.2593 116 31.3943 116 35.2617V98.7467C116 102.614 112.865 105.748 108.998 105.748H7.00243C3.1351 105.748 0.000186812 102.614 0 98.7467V49.2656C0 45.3982 3.13498 42.2632 7.00243 42.2632H58L69.9521 30.3111C70.6024 29.6606 71.3752 29.1448 72.225 28.7928C73.0748 28.4408 73.9856 28.2592 74.9054 28.2593H108.998Z" />
                            </svg>
                            <svg width="35" height="35" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                                *ngIf="folder.type==='File'" xmlns:xlink="http://www.w3.org/1999/xlink"
                                viewBox="0 0 116 116" style="max-width: 55%; height: auto;" xml:space="preserve">
                                <path class="st0"
                                    d="M11.6,98.6c0,1.5,0.6,3,1.7,4.1c1.1,1.1,2.6,1.7,4.1,1.7h7.7V90.9h-9.7C15.5,90.9,11.6,90.9,11.6,98.6z" />
                                <path class="st1" d="M104.4,23.2v83.1c0,2.1-0.8,4-2.3,5.5c-1.5,1.5-3.4,2.3-5.5,2.3H30.9c-2.1,0-4-0.8-5.5-2.3
        c-1.5-1.5-2.3-3.4-2.3-5.5V9.7c0-2.1,0.8-4,2.3-5.5c1.5-1.5,3.4-2.3,5.5-2.3h52.2L104.4,23.2z" />
                                <path class="st2" d="M104.4,23.2H85.1c-1.1,0-1.9-0.9-1.9-1.9V1.9L104.4,23.2z" />
                                <path class="st3" d="M17.4,92.8H87c1.5,0,3-0.6,4.1-1.7c1.1-1.1,1.7-2.6,1.7-4.1V59.9c0-1.5-0.6-3-1.7-4.1s-2.6-1.7-4.1-1.7H17.4
        c-1.5,0-3,0.6-4.1,1.7s-1.7,2.6-1.7,4.1v38.7c0-1.5,0.6-3,1.7-4.1C14.4,93.4,15.9,92.8,17.4,92.8z" />

                                <text x="30" y="84" class="label">{{ getFileTypeText(folder.file_type) }}</text>
                            </svg>
                        </td>
                        <td>
                            <span *ngIf="folder.type==='Folder'">{{folder.name}}</span>
                            <span *ngIf="folder.type==='File'"> <h6>{{ getCleanName(folder.name) }}</h6></span>
                        </td>
                        <td>
                            <span *ngIf="folder.type==='Folder'">{{folder?.children.length}}</span>
                        </td>
                        <td>
                            <span>{{ formatFileSize(folder.size) }}</span>

                        </td>
                        <td>
                            {{folder.created_at | date:'dd/MM/yyyy'}}
                        </td>
                        <td>
                            {{folder.created_at | date:'dd/MM/yyyy'}}
                        </td>
                        <div class="actions-cell" style="display: none;">
                            <button class="edit-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                                    <g fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path
                                            d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z" />
                                        <path
                                            d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3" />
                                    </g>
                                </svg>
                            </button>
                            <button class="remove-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"
                                        d="M9.17 4a3.001 3.001 0 0 1 5.66 0m5.67 2h-17m15.333 2.5l-.46 6.9c-.177 2.654-.265 3.981-1.13 4.79s-2.196.81-4.856.81h-.774c-2.66 0-3.991 0-4.856-.81c-.865-.809-.954-2.136-1.13-4.79l-.46-6.9M9.5 11l.5 5m4.5-5l-.5 5" />
                                </svg>
                            </button>
                            <button class="view-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                                    <g fill="none" stroke="currentColor" stroke-width="1.5">
                                        <path stroke-linecap="round"
                                            d="M22 10.5V12c0 4.714 0 7.071-1.465 8.535C19.072 22 16.714 22 12 22s-7.071 0-8.536-1.465C2 19.072 2 16.714 2 12s0-7.071 1.464-8.536C4.93 2 7.286 2 12 2h1.5" />
                                        <path
                                            d="m16.652 3.455l.649-.649A2.753 2.753 0 0 1 21.194 6.7l-.65.649m-3.892-3.893s.081 1.379 1.298 2.595c1.216 1.217 2.595 1.298 2.595 1.298m-3.893-3.893L10.687 9.42c-.404.404-.606.606-.78.829q-.308.395-.524.848c-.121.255-.211.526-.392 1.068L8.412 13.9m12.133-6.552l-5.965 5.965c-.404.404-.606.606-.829.78a4.6 4.6 0 0 1-.848.524c-.255.121-.526.211-1.068.392l-1.735.579m0 0l-1.123.374a.742.742 0 0 1-.939-.94l.374-1.122m1.688 1.688L8.412 13.9" />
                                    </g>
                                </svg>
                            </button>
                        </div>

                    </tr>

                    <tr *ngIf="isLoading">
                        <td colspan="6" class="text-center py-3">
                            <div class="progress" style="height: 25px;">
                                <div class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
                                    role="progressbar" [style.width.%]="uploadProgress"
                                    [attr.aria-valuenow]="uploadProgress" aria-valuemin="0" aria-valuemax="100">
                                    {{ uploadProgress }}%
                                </div>
                            </div>
                        </td>
                    </tr>


                </tbody>
            </table>

            <div class="added-btns d-flex align-items-stretch justify-content-end gap-3 mt-4">
                <button class="btn btn-lg btn-outline-primary w-auto" (click)="fileInput.click()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">

                        <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5">
                            <path
                                d="M17 9.002c2.175.012 3.353.109 4.121.877C22 10.758 22 12.172 22 15v1c0 2.829 0 4.243-.879 5.122C20.243 22 18.828 22 16 22H8c-2.828 0-4.243 0-5.121-.878C2 20.242 2 18.829 2 16v-1c0-2.828 0-4.242.879-5.121c.768-.768 1.946-.865 4.121-.877" />
                            <path stroke-linejoin="round" d="M12 15V2m0 0l3 3.5M12 2L9 5.5" />
                        </g>
                    </svg>
                    <span>Upload</span>
                </button>

                <input #fileInput type="file" hidden (change)="onFileSelected($event)" />

                <button class="btn btn-lg btn-outline-primary w-auto" (click)="openModalNewFolder()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                        <g fill="none" stroke="currentColor" stroke-width="1.5">
                            <path stroke-linecap="round" d="M10 14h2m0 0h2m-2 0v2m0-2v-2" />
                            <path
                                d="M2 6.95c0-.883 0-1.324.07-1.692A4 4 0 0 1 5.257 2.07C5.626 2 6.068 2 6.95 2c.386 0 .58 0 .766.017a4 4 0 0 1 2.18.904c.144.119.28.255.554.529L11 4c.816.816 1.224 1.224 1.712 1.495a4 4 0 0 0 .848.352C14.098 6 14.675 6 15.828 6h.374c2.632 0 3.949 0 4.804.77q.119.105.224.224c.77.855.77 2.172.77 4.804V14c0 3.771 0 5.657-1.172 6.828S17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.172S2 17.771 2 14z" />
                        </g>
                    </svg>
                    <span>New Folder</span>
                </button>
            </div>



        </div>
    </div>
</div>




<!-- create new File -->
<app-popup [title]="'Create New File'" [paragraph1]="'Please enter Filename'" [isOpen]="createFilePop"
    (close)="closeModalFile()">
    <div class="input">
        <div class="form-outline w-100 position-relative custom-date-wrapper">
            <input type="text" id="fileName" class="form-control custom-date-input" placeholder="File Name" />
        </div>

    </div>
    <button modal-btn-left class="btn btn-lg btn-primary w-100">
        Create File
    </button>
    <button modal-btn-right class="btn btn-lg btn-outline-dark border-0 w-100" (click)="closeModalFile()">
        Cancel
    </button>
</app-popup>

<!-- create new folder -->
<app-popup [title]="'Create folder'" [paragraph1]="'Please enter folder name'" [isOpen]="createFolderPop"
    (close)="closeModalFolder()">
    <div class="input">
        <div class="form-outline w-100 position-relative custom-date-wrapper">
            <input type="text" id="foldername" class="form-control custom-date-input" name="foldername"
                autocomplete="off" [(ngModel)]="newFolderName" placeholder="Folder Name" />
        </div>
        <div class="alert alert-danger mb-0 mt-2" role="alert" *ngIf="errMsg">
            {{errMsg}}
        </div>
    </div>
    <button modal-btn-left class="btn btn-lg btn-primary w-100" (click)="createFolder()">
        <span *ngIf="!isLoading">Create Folder</span>
        <span *ngIf="isLoading" class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
    </button>
    <button modal-btn-right class="btn btn-lg btn-outline-dark border-0 w-100" (click)="closeModalFolder()">
        Cancel
    </button>
</app-popup>