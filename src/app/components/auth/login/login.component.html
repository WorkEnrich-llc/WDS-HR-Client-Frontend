<main class="login-card" role="main" aria-label="Login">
  <div class="card-top">
    <div class="row align-items-center g-3">
      <div class="col-8">
        <h1 class="login-title">Login</h1>
        <p id="login-desc" class="login-desc">Enter your work email and password to sign in to your account.</p>
        <p class="link">
          Don't have an account?
          <a routerLink="/auth/register" class="register-link">Create account</a>
        </p>
      </div>
      <div class="col-4">
        <img src="./images/logo_with_slog.png" alt="WDS logo" width="400" height="auto">
      </div>
    </div>
  </div>

  <div class="card-bottom">
    <div class="login-info">
      <div class="row align-items-center g-4">
        <div class="col-6">
          <form [formGroup]="loginForm" class="w-100 d-flex flex-column gap-2" [class.form-loading]="isLoading || isRedirecting" (ngSubmit)="login()" aria-labelledby="login-title" aria-describedby="login-desc">
            <div class="input">
              <label for="email" class="input-label">
                <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <g fill="none" stroke-width="1.5">
                    <path d="M2 12c0-3.771 0-5.657 1.172-6.828S6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172S22 8.229 22 12s0 5.657-1.172 6.828S17.771 20 14 20h-4c-3.771 0-5.657 0-6.828-1.172S2 15.771 2 12Z" />
                    <path stroke-linecap="round" d="m6 8l2.159 1.8c1.837 1.53 2.755 2.295 3.841 2.295s2.005-.765 3.841-2.296L18 8" />
                  </g>
                </svg>
                <span>Email</span>
              </label>
              <div class="d-flex align-items-center gap-4">
                <div class="form-outline w-100 position-relative custom-date-wrapper">
                  <input
                    formControlName="email"
                    type="email"
                    id="email"
                    class="form-control"
                    placeholder="e.g. you@company.com"
                    autocomplete="email"
                    inputmode="email"
                    [attr.aria-invalid]="loginForm.get('email')?.touched && loginForm.get('email')?.invalid"
                    [attr.aria-describedby]="(loginForm.get('email')?.touched && loginForm.get('email')?.invalid) ? 'email-error' : null"
                    [ngClass]="{
                      'error-input': loginForm.get('email')?.touched && loginForm.get('email')?.invalid,
                      'success-input': loginForm.get('email')?.touched && loginForm.get('email')?.valid
                    }">
                </div>
              </div>
              @if (loginForm.get('email')?.touched && loginForm.get('email')?.errors?.['required']) {
                <p id="email-error" class="error-msg" role="alert">Email is required.</p>
              }
              @if (loginForm.get('email')?.touched && loginForm.get('email')?.errors?.['email']) {
                <p id="email-error" class="error-msg" role="alert">Please enter a valid email address.</p>
              }
            </div>

            <div class="input">
              <label for="password" class="input-label">
                <svg class="input-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <g fill="none">
                    <path stroke-width="1.5" d="M2 16c0-2.828 0-4.243.879-5.121C3.757 10 5.172 10 8 10h8c2.828 0 4.243 0 5.121.879C22 11.757 22 13.172 22 16s0 4.243-.879 5.121C20.243 22 18.828 22 16 22H8c-2.828 0-4.243 0-5.121-.879C2 20.243 2 18.828 2 16Z" />
                    <path stroke-linecap="round" stroke-width="1.5" d="M6 10V8a6 6 0 1 1 12 0v2" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16h.009m3.982 0H12m3.991 0H16" />
                  </g>
                </svg>
                <span>Password</span>
              </label>
              <div class="d-flex align-items-center gap-4">
                <div class="form-outline w-100 position-relative custom-date-wrapper password-input-wrapper">
                  <input
                    formControlName="password"
                    [type]="isPasswordVisible ? 'text' : 'password'"
                    id="password"
                    class="form-control"
                    placeholder="Enter your password"
                    autocomplete="current-password"
                    [attr.aria-invalid]="loginForm.get('password')?.touched && loginForm.get('password')?.invalid"
                    [attr.aria-describedby]="(loginForm.get('password')?.touched && loginForm.get('password')?.invalid) ? 'password-error' : null"
                    [ngClass]="{
                      'error-input': loginForm.get('password')?.touched && loginForm.get('password')?.invalid,
                      'success-input': loginForm.get('password')?.touched && loginForm.get('password')?.valid
                    }">
                  <button
                    type="button"
                    class="toggle-password"
                    [attr.aria-label]="isPasswordVisible ? 'Hide password' : 'Show password'"
                    [attr.aria-pressed]="isPasswordVisible"
                    (click)="togglePassword()">
                    @if (!isPasswordVisible) {
                      <svg class="toggle-password-icon icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 90 90" aria-hidden="true">
                        <path class="icon-eye-outline" fill="currentColor" d="M 45 73.264 c -14.869 0 -29.775 -8.864 -44.307 -26.346 c -0.924 -1.112 -0.924 -2.724 0 -3.836 C 15.225 25.601 30.131 16.737 45 16.737 c 14.868 0 29.775 8.864 44.307 26.345 c 0.925 1.112 0.925 2.724 0 3.836 C 74.775 64.399 59.868 73.264 45 73.264 z M 6.934 45 C 19.73 59.776 32.528 67.264 45 67.264 c 12.473 0 25.27 -7.487 38.066 -22.264 C 70.27 30.224 57.473 22.737 45 22.737 C 32.528 22.737 19.73 30.224 6.934 45 z"/>
                        <path class="icon-eye-pupil" fill="currentColor" d="M 45 62 c -9.374 0 -17 -7.626 -17 -17 s 7.626 -17 17 -17 s 17 7.626 17 17 S 54.374 62 45 62 z M 45 34 c -6.065 0 -11 4.935 -11 11 s 4.935 11 11 11 s 11 -4.935 11 -11 S 51.065 34 45 34 z"/>
                      </svg>
                    }
                    @if (isPasswordVisible) {
                      <svg class="toggle-password-icon icon-eye-off" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 90 90" aria-hidden="true">
                        <path class="icon-eye-outline" fill="currentColor" d="M 45 73.264 c -14.869 0 -29.775 -8.864 -44.307 -26.346 c -0.924 -1.112 -0.924 -2.724 0 -3.836 C 15.225 25.601 30.131 16.737 45 16.737 c 14.868 0 29.775 8.864 44.307 26.345 c 0.925 1.112 0.925 2.724 0 3.836 C 74.775 64.399 59.868 73.264 45 73.264 z M 6.934 45 C 19.73 59.776 32.528 67.264 45 67.264 c 12.473 0 25.27 -7.487 38.066 -22.264 C 70.27 30.224 57.473 22.737 45 22.737 C 32.528 22.737 19.73 30.224 6.934 45 z"/>
                        <path class="icon-eye-pupil" fill="currentColor" d="M 45 62 c -9.374 0 -17 -7.626 -17 -17 s 7.626 -17 17 -17 s 17 7.626 17 17 S 54.374 62 45 62 z M 45 34 c -6.065 0 -11 4.935 -11 11 s 4.935 11 11 11 s 11 -4.935 11 -11 S 51.065 34 45 34 z"/>
                        <line class="icon-eye-slash" x1="8" y1="8" x2="82" y2="82" stroke="currentColor" stroke-width="4" stroke-linecap="round"/>
                      </svg>
                    }
                  </button>
                </div>
              </div>
              @if (loginForm.get('password')?.touched && loginForm.get('password')?.errors?.['required']) {
                <p id="password-error" class="error-msg" role="alert">Password is required.</p>
              }
            </div>

            @if (errMsg) {
              <div class="alert alert-danger mb-0 mt-2" role="alert" aria-live="polite">
                {{ errMsg }}
              </div>
            }

            <a routerLink="/auth/reset-password" class="forgrt-pass ms-auto my-3">Forgot password?</a>

            <button
              type="submit"
              class="btn btn-lg btn-primary w-100 btn-login"
              [class.btn-login--loading]="isLoading && !isRedirecting"
              [class.btn-login--redirecting]="isRedirecting"
              [disabled]="isLoading || isRedirecting || !loginForm.valid"
              [attr.aria-busy]="isLoading || isRedirecting"
              aria-label="Sign in">
              @if (isRedirecting) {
                <span class="btn-login-content btn-login-content--redirecting">
                  <svg class="btn-login-check" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                    <polyline points="20 6 9 17 4 12"/>
                  </svg>
                  <span>Redirecting…</span>
                </span>
              }
              @if (isLoading && !isRedirecting) {
                <span class="btn-login-content btn-login-content--loading">
                  <span class="spinner-grow spinner-grow-sm btn-login-spinner" role="status" aria-hidden="true"></span>
                  <span>Signing you in…</span>
                </span>
              }
              @if (!isLoading && !isRedirecting) {
                <span class="btn-login-content btn-login-content--idle">
                  <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 12h16m0 0l-6-6m6 6l-6 6" />
                  </svg>
                  <span>Login</span>
                </span>
              }
            </button>
          </form>

        </div>
        <div class="d-none d-md-block col-md-6 text-center">
          <img src="./images/verify.svg" alt="" role="presentation">
        </div>
      </div>
    </div>
  </div>
</main>