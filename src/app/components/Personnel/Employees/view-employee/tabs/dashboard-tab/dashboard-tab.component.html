<div class="dashboard-tab-content">
  @if (isLoading) {
    <div class="d-flex justify-content-center align-items-center w-100" style="min-height: 400px">
      <div class="spinner-border text-primary" style="width: 3rem; height: 3rem" role="status"></div>
    </div>
  } @else {
    <div class="dashboard-grid">
      <!-- Attendance Card -->
      <div class="content-box chart-card">
        <div class="card-header d-flex align-items-center justify-content-between mb-4">
          <h2>Attendance</h2>
          <div class="form-outline select-inner">
            <select class="form-select" (change)="onParamChangeEvent('attendance_year', $event)">
              @for (y of years; track $index) {
                <option [value]="y.value">{{ y.label }}</option>
              }
            </select>
          </div>
        </div>
        <div class="chart-container" style="height: 250px;">
          <canvas baseChart [data]="attendanceData" [type]="'bar'" [options]="attendanceOptions"></canvas>
        </div>
      </div>

      <!-- Requests Card -->
      <div class="content-box chart-card">
        <div class="card-header d-flex align-items-center justify-content-between mb-4">
          <h2>Requests</h2>
          <div class="form-outline select-inner">
            <select class="form-select" (change)="onParamChangeEvent('request_month', $event)">
              @for (m of months; track $index) {
                <option [value]="m.value">{{ m.label }}</option>
              }
            </select>
          </div>
        </div>
        <div class="d-flex align-items-center gap-4">
          <div class="chart-wrapper position-relative" style="width: 200px; height: 200px;">
            <canvas baseChart [data]="requestsData" [type]="'doughnut'" [options]="requestsOptions"></canvas>
          </div>
          <div class="chart-legend flex-fill">
            <div class="legend-list d-flex flex-column gap-2">
              @for (item of getSectionValues('Requests'); track $index) {
                <div class="sticker">
                  <div class="number">{{ item.value }}</div>
                  <div class="label-color" [style.background-color]="item.color_code"></div>
                  <p>{{ item.label }}</p>
                </div>
              }
              <div class="legend-divider"></div>
              <div class="sticker total">
                <div class="number">{{ getSectionTotal('Requests') }}</div>
                <div class="label-color" style="background-color: transparent"></div>
                <p>Total</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Leave Balance Card -->
      <div class="content-box chart-card">
        <div class="card-header d-flex align-items-center justify-content-between mb-4">
          <h2>Leave Balance</h2>
          <div class="form-outline select-inner">
            <select class="form-select" (change)="onParamChangeEvent('leave_balance_leave_id', $event)">
              <option value="">All Leave Types</option>
              @for (lt of leaveTypes; track $index) {
                <option [value]="lt.leave.id">{{ lt.leave.name }}</option>
              }
            </select>
          </div>
        </div>
        <div class="d-flex align-items-center gap-4">
          <div class="chart-wrapper position-relative" style="width: 200px; height: 200px;">
            <canvas baseChart [data]="leaveBalanceData" [type]="'doughnut'" [options]="leaveBalanceOptions"></canvas>
          </div>
          <div class="chart-legend flex-fill">
            <div class="legend-list d-flex flex-column gap-2">
              @for (item of getSectionValues('Leave Balance'); track $index) {
                <div class="sticker">
                  <div class="number">{{ item.value }}</div>
                  <div class="label-color" [style.background-color]="item.color_code"></div>
                  <p>{{ item.label }}</p>
                </div>
              }
              <div class="legend-divider"></div>
              <div class="sticker total">
                <div class="number">{{ getSectionTotal('Leave Balance') }}</div>
                <div class="label-color" style="background-color: transparent"></div>
                <p>Total</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>
