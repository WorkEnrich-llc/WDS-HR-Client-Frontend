<div class="content-hug">
    <div class="content-box d-flex flex-column gap-3">
        <h2>Contract Details</h2>
        <div formGroupName="contract_details" class="w-lg-50 d-flex flex-column gap-2">
            <div class="input">
                <label for="start_contract">Contract Start Date <span>*</span></label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <input type="date" id="start_contract" formControlName="start_contract"
                            class="form-control custom-date-input"
                            />
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <g fill="none" stroke-width="1.5">
                                <path stroke-linecap="round"
                                    d="M22 14v-2c0-3.771 0-5.657-1.172-6.828S17.771 4 14 4h-4C6.229 4 4.343 4 3.172 5.172S2 8.229 2 12v2c0 3.771 0 5.657 1.172 6.828S6.229 22 10 22h4M7 4V2.5M17 4V2.5" />
                                <circle cx="18" cy="18" r="3" />
                                <path stroke-linecap="round" d="M20.5 20.5L22 22M2.5 9h19" />
                            </g>
                        </svg>
                    </div>
                </div>
                <p class="error-msg" *ngIf="sharedService.isFieldInvalid('start_contract', sharedService.contractDetails)">
                    {{sharedService.getFieldError('start_contract', sharedService.contractDetails)}}
                </p>
            </div>

            <div class="form-check d-flex align-items-end justify-content-start p-0 m-0 gap-3">
                <input class="form-check-input m-0" type="checkbox" id="withEnd" [checked]="sharedService.withEndDate"
                    (change)="sharedService.contractDetails.get('contract_type')?.setValue($any($event.target).checked ? 1 : 2)" />
                <label class="form-check-label m-0" for="withEnd">
                    With end date
                </label>
            </div>

            <div class="input">
                <label for="contract_end_date">Contract End Date</label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <input type="date" id="contract_end_date" formControlName="contract_end_date"
                            class="form-control custom-date-input"
                           
                            [disabled]="!sharedService.withEndDate" />
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                            <g fill="none" stroke-width="1.5">
                                <path stroke-linecap="round"
                                    d="M22 14v-2c0-3.771 0-5.657-1.172-6.828S17.771 4 14 4h-4C6.229 4 4.343 4 3.172 5.172S2 8.229 2 12v2c0 3.771 0 5.657 1.172 6.828S6.229 22 10 22h4M7 4V2.5M17 4V2.5" />
                                <circle cx="18" cy="18" r="3" />
                                <path stroke-linecap="round" d="M20.5 20.5L22 22M2.5 9h19" />
                            </g>
                        </svg>
                    </div>
                </div>
                <p class="error-msg" *ngIf="sharedService.isFieldInvalid('contract_end_date', sharedService.contractDetails)">
                    {{sharedService.getFieldError('contract_end_date', sharedService.contractDetails)}}
                </p>
            </div>

            <div class="input">
                <label for="employment_type">Employment Type <span>*</span></label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <select id="employment_type" formControlName="employment_type" class="form-select"
                            >
                            <option value="" disabled hidden>Select Employment Type</option>
                            <option *ngFor="let type of sharedService.employmentTypes()" [value]="type.id">{{ type.name }}
                            </option>
                        </select>
                    </div>
                </div>
                <p class="error-msg" *ngIf="sharedService.isFieldInvalid('employment_type', sharedService.contractDetails)">
                    {{sharedService.getFieldError('employment_type', sharedService.contractDetails)}}
                </p>
            </div>

            <div class="input">
                <label for="work_mode">Work Mode <span>*</span></label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <select id="work_mode" formControlName="work_mode" class="form-select"
                           >
                            <option value="" disabled hidden>Select Work Mode</option>
                            <option *ngFor="let mode of sharedService.workModes()" [value]="mode.id">{{ mode.name }}</option>
                        </select>
                    </div>
                </div>
                <p class="error-msg" *ngIf="sharedService.isFieldInvalid('work_mode', sharedService.contractDetails)">
                    {{sharedService.getFieldError('work_mode', sharedService.contractDetails)}}
                </p>
            </div>

            <div class="input">
                <label for="days_on_site">No. of Days on site</label>
                <div class="form-outline w-100 position-relative custom-date-wrapper">
                    <input type="number" id="days_on_site" formControlName="days_on_site"
                        class="form-control custom-date-input"
 placeholder="Max: 7"
                        min="0" max="7" />
                </div>
                <p class="error-msg" *ngIf="sharedService.isFieldInvalid('days_on_site', sharedService.contractDetails)">
                    {{sharedService.getFieldError('days_on_site', sharedService.contractDetails)}}
                </p>
            </div>

            <div class="input">
                <label for="salary">Salary <span>*</span></label>
                <div class="form-outline w-100 position-relative custom-date-wrapper">
                    <input type="number" id="salary" formControlName="salary" class="form-control custom-date-input"
                        
                        placeholder="Enter the Employee Salary" 
                        [min]="sharedService.currentSalaryRange()?.minimum || 0" 
                        [max]="sharedService.currentSalaryRange()?.maximum || 999999999"
                        step="0.01" />
                </div>
                <p class="error-msg" *ngIf="sharedService.isFieldInvalid('salary', sharedService.contractDetails)">
                    {{sharedService.getFieldError('salary', sharedService.contractDetails)}}
                </p>
            </div>

            <div class="salary-info d-flex justify-content-between gap-3" *ngIf="sharedService.getSalaryRangeDisplay()">
                <div class="d-flex flex-column w-100">
                    <span>Min. Salary</span>
                    <h6>{{sharedService.getSalaryRangeDisplay()?.min}} {{sharedService.getSalaryRangeDisplay()?.currency}}</h6>
                </div>
                <div class="d-flex flex-column w-100">
                    <span>Max. Salary</span>
                    <h6>{{sharedService.getSalaryRangeDisplay()?.max}} {{sharedService.getSalaryRangeDisplay()?.currency}}</h6>
                </div>
            </div>

            <div class="alert alert-info mb-0 mt-2" *ngIf="!sharedService.getSalaryRangeDisplay() && sharedService.contractDetails.get('employment_type')?.value && sharedService.selectedJobTitle()">
                <small>No salary range defined for this employment type and job title.</small>
            </div>

            <div class="alert alert-danger mb-0 mt-3" role="alert" *ngIf="sharedService.errMsg()">
                {{sharedService.errMsg()}}
            </div>
        </div>

        <!-- prev and submit buttons -->
        <div class="btn-fixed d-flex align-items-stretch gap-2">
            <button type="button"
                class="btn btn-outline-success bg-white d-flex justify-content-center align-items-center"
                (click)="goPrev()">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="1.5" d="M20 12H4m0 0l6-6m-6 6l6 6" />
                </svg>
            </button>
            <button type="button" class="btn btn-lg btn-success" (click)="onSubmit()">
                <span *ngIf="sharedService.isLoading()" class="spinner-grow spinner-grow-sm" role="status"
                    aria-hidden="true"></span>
                <svg *ngIf="!sharedService.isLoading()" xmlns="http://www.w3.org/2000/svg" width="22" height="22"
                    viewBox="0 0 24 24">
                    <g fill="none" stroke="currentColor" stroke-width="1.5">
                        <circle cx="12" cy="12" r="10" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="m8.5 12.5l2 2l5-5" />
                    </g>
                </svg>
                <span>Create Employee</span>
            </button>
        </div>
    </div>
</div>
