<div class="content-hug">
    <div class="content-box d-flex flex-column gap-3">
        <h2>Job Details</h2>
        <div formGroupName="job_details" class="w-lg-50 d-flex flex-column gap-2">
            <div class="input">
                <label for="branch_id">Branch <span>*</span></label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <select id="branch_id" formControlName="branch_id" class="form-select"
                            [class.is-invalid]="sharedService.isFieldInvalid('branch_id', sharedService.jobDetails)">
                            <option value="" disabled hidden>Select Branch</option>
                            @for (branch of sharedService.getActiveBranches(); track branch.id) {
                                <option [value]="branch.id">{{branch.name}}</option>
                            }
                        </select>
                    </div>
                </div>
                @if (sharedService.isFieldInvalid('branch_id', sharedService.jobDetails)) {
                    <p class="error-msg text-danger">
                        {{sharedService.getFieldError('branch_id', sharedService.jobDetails)}}
                    </p>
                }
            </div>

            <div class="input">
                <label for="department_id">Department <span>*</span></label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <select id="department_id" formControlName="department_id" class="form-select"
                            [class.is-invalid]="sharedService.isFieldInvalid('department_id', sharedService.jobDetails)">
                            <option value="" disabled hidden>Select Department</option>
                            @for (dept of sharedService.getActiveDepartments(); track dept.id) {
                                <option [value]="dept.id">{{dept.name}}</option>
                            }
                        </select>
                    </div>
                </div>
                @if (sharedService.isFieldInvalid('department_id', sharedService.jobDetails)) {
                    <p class="error-msg text-danger">
                        {{sharedService.getFieldError('department_id', sharedService.jobDetails)}}
                    </p>
                }
            </div>

            <div class="input">
                <label for="section_id">Section</label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <select id="section_id" formControlName="section_id" class="form-select" 
                            [disabled]="sharedService.getSections().length === 0">
                            <option value="" disabled hidden>
                                {{sharedService.getSections().length === 0 ? 'Select Department first' : 'Select Section'}}
                            </option>
                            @for (section of sharedService.getSections(); track section.id) {
                                <option [value]="section.id">{{section.name}}</option>
                            }
                        </select>
                    </div>
                </div>
            </div>

            <div class="input">
                <label for="job_title_id">Job Title <span>*</span></label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <select id="job_title_id" formControlName="job_title_id" class="form-select"
                            [class.is-invalid]="sharedService.isFieldInvalid('job_title_id', sharedService.jobDetails)">
                            <option value="" disabled hidden>Select Job Title</option>
                            @for (job of sharedService.jobTitles(); track job.id) {
                                <option [value]="job.id">{{job.name}}</option>
                            }
                        </select>
                    </div>
                </div>
                @if (sharedService.isFieldInvalid('job_title_id', sharedService.jobDetails)) {
                    <p class="error-msg text-danger">
                        {{sharedService.getFieldError('job_title_id', sharedService.jobDetails)}}
                    </p>
                }
            </div>

            <div class="input">
                <label for="work_schedule_id">Work Schedule <span>*</span></label>
                <div class="d-flex align-items-center gap-4">
                    <div class="form-outline w-100 position-relative custom-date-wrapper">
                        <select id="work_schedule_id" formControlName="work_schedule_id" class="form-select"
                            [class.is-invalid]="sharedService.isFieldInvalid('work_schedule_id', sharedService.jobDetails)">
                            <option value="" disabled hidden>Select Work Schedule</option>
                            @for (schedule of sharedService.getActiveWorkSchedules(); track schedule.id) {
                                <option [value]="schedule.id">{{schedule.name}}</option>
                            }
                        </select>
                    </div>
                </div>
                @if (sharedService.isFieldInvalid('work_schedule_id', sharedService.jobDetails)) {
                    <p class="error-msg text-danger">
                        {{sharedService.getFieldError('work_schedule_id', sharedService.jobDetails)}}
                    </p>
                }
            </div>

            @if (sharedService.errMsg()) {
                <div class="alert alert-danger mb-0 mt-3" role="alert">
                    {{sharedService.errMsg()}}
                </div>
            }
        </div>

        <!-- prev and next buttons -->
        <div class="btn-fixed d-flex align-items-stretch gap-2">
            <button type="button"
                class="btn btn-outline-success bg-white d-flex justify-content-center align-items-center"
                (click)="goPrev()">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="1.5" d="M20 12H4m0 0l6-6m-6 6l6 6" />
                </svg>
            </button>
            <button type="button" class="btn btn-lg btn-primary" (click)="goNext()">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                    <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
                        stroke-width="1.5" d="M4 12h16m0 0l-6-6m6 6l-6 6" />
                </svg>
                <span>Next (2/3)</span>
            </button>
        </div>
    </div>
</div>
