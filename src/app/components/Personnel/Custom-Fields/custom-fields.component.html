<!-- start page header -->
<app-page-header [breadcrumbs]="[
    { label: 'Custom Fields', link: '/custom-fields' },
    { label: 'Custom Fields' }
  ]" title="All Custom Fields">
</app-page-header>
<!-- end page header -->

<!-- start page content -->
<div class="content-hug">
  <div class="content-box d-flex flex-column gap-3">
    <!-- start search and filter -->
    <div class="d-flex flex-column flex-lg-row align-items-start align-lg-items-center justify-content-between gap-2">
      <div class="d-flex align-items-center gap-2 w-100 w-lg-50">
        <!-- Search input -->
        <div data-mdb-input-init class="form-outline w-75">
          <input type="text" class="form-control" placeholder="Search" [(ngModel)]="searchTerm"
            (ngModelChange)="onSearchChange()" />
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
              <g fill="none" stroke-width="1.5">
                <circle cx="11.5" cy="11.5" r="9.5" />
                <path stroke-linecap="round" d="M18.5 18.5L22 22" />
              </g>
            </svg>
          </div>
        </div>

        <button class="btn btn-lg btn-primary" routerLink="/custom-fields/manage-custom-fields">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
            <g fill="none" stroke="currentColor" stroke-width="1.5">
              <circle cx="12" cy="12" r="10" />
              <path stroke-linecap="round" d="M15 12h-3m0 0H9m3 0V9m0 3v3" />
            </g>
          </svg>
          <span>New Custom Field</span>
        </button>
      </div>

      <!-- start Table -->

      <app-table [data]="customFields " [isLoading]="loadData" [columnsCount]="5" [totalItems]="totalItems"
        [itemsPerPage]="itemsPerPage" [currentPage]="currentPage" (pageChange)="onPageChange($event)"
        (itemsPerPageChange)="onItemsPerPageChange($event)" [headerTemplate]="customFieldsTableHeader"
      [rowTemplate]="customFieldTableRow" [emptyTemplate]="noCustomField"></app-table>

      <ng-template #customFieldsTableHeader>
        <th (click)="sortBy()" style="cursor: pointer;">
          <div class="d-flex align-items-center justify-content-between">
            <span>Custom Field</span>
            @if (sortDirection === 'desc') {
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                viewBox="0 0 24 24">
                <g fill="none" stroke="#DDE3EB" stroke-linecap="round" stroke-width="1.5">
                  <path d="M4 8h9m-7 5h7m-5 5h5" />
                  <path stroke-linejoin="round" d="M17 20V4l3 4" />
                </g>
              </svg>
            }
            @if (sortDirection === 'asc') {
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                viewBox="0 0 24 24">
                <path fill="#DDE3EB" fill-rule="evenodd"
                  d="M17 3.25a.75.75 0 0 1 .75.75v13.75l1.65-2.2a.75.75 0 1 1 1.2.9l-3 4a.75.75 0 0 1-1.35-.45V4a.75.75 0 0 1 .75-.75M7.25 6A.75.75 0 0 1 8 5.25h5a.75.75 0 0 1 0 1.5H8A.75.75 0 0 1 7.25 6m-2 5a.75.75 0 0 1 .75-.75h7a.75.75 0 0 1 0 1.5H6a.75.75 0 0 1-.75-.75m-2 5a.75.75 0 0 1 .75-.75h9a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.75-.75"
                  clip-rule="evenodd" />
                </svg>
              }
            </div>
          </th>
          <th>Information Section</th>
          <th>Data Type</th>
          <th>Pinned</th>
          <!-- <th>Mandatory</th> -->
          <th>Actions</th>
        </ng-template>

        <ng-template #customFieldTableRow let-customField let-i="index">
          <td>
            <!-- <span class="d-block text-gray-sm">{{ customField.id.toString().padStart(4, '0') }}</span> -->
            <span class="d-block text-truncate" style="max-width: 300px;">
              {{ customField.input_option.label }}
            </span>
          </td>
          <td>
            {{ customField.target_model }}
          </td>
          <td>
            {{customField.input_option.type}}
          </td>
          <td>

            @if(customField.pinned){<div>
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round" xmlns="http://www.w3.org/2000/svg">

                <path
                  d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48" />
                  <path d="M12 15V9" />
                  <path d="M15 12H9" />
                </svg>

              </div>
            }
            @else{<div>
            <span>{{'No'}}</span>
          </div>
        }
      </td>
      <!-- <td>

      @if(customField.input_option.required){<div class="badge-newjoiner">
        <svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M11.0852 6.58525C11.3049 6.36558 11.3049 6.00942 11.0852 5.78975C10.8656 5.57008 10.5094 5.57008 10.2898 5.78975L6.9375 9.142L5.83525 8.03975C5.61558 7.82008 5.25942 7.82008 5.03975 8.03975C4.82008 8.25942 4.82008 8.61558 5.03975 8.83525L6.53975 10.3352C6.75942 10.5549 7.11558 10.5549 7.33525 10.3352L11.0852 6.58525Z"
            fill="#377AFD" />
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M8.0625 0C3.6097 0 0 3.6097 0 8.0625C0 12.5153 3.6097 16.125 8.0625 16.125C12.5153 16.125 16.125 12.5153 16.125 8.0625C16.125 3.6097 12.5153 0 8.0625 0ZM1.125 8.0625C1.125 4.23102 4.23102 1.125 8.0625 1.125C11.894 1.125 15 4.23102 15 8.0625C15 11.894 11.894 15 8.0625 15C4.23102 15 1.125 11.894 1.125 8.0625Z"
              fill="#377AFD" />
            </svg>

            <span>{{'Yes'}}</span>
          </div>
        }
        @else{<div class="badge-gray">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
          <g clip-path="url(#clip0_3133_17902)">
            <g clip-path="url(#clip1_3133_17902)">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M9 0.9375C4.5472 0.9375 0.9375 4.5472 0.9375 9C0.9375 13.4528 4.5472 17.0625 9 17.0625C13.4528 17.0625 17.0625 13.4528 17.0625 9C17.0625 4.5472 13.4528 0.9375 9 0.9375ZM2.0625 9C2.0625 5.16852 5.16852 2.0625 9 2.0625C10.7134 2.0625 12.2817 2.68363 13.492 3.71299C13.487 3.71764 13.4821 3.72239 13.4773 3.72725L3.72727 13.4771C3.72238 13.482 3.7176 13.4869 3.71292 13.492C2.6836 12.2816 2.0625 10.7133 2.0625 9ZM4.50787 14.2869C5.71824 15.3163 7.28658 15.9375 9 15.9375C12.8315 15.9375 15.9375 12.8315 15.9375 9C15.9375 7.28662 15.3164 5.71832 14.287 4.50797C14.2824 4.51296 14.2776 4.51789 14.2727 4.52276L4.52276 14.2726C4.51786 14.2775 4.5129 14.2823 4.50787 14.2869Z"
                fill="#4A6D97" />
              </g>
            </g>
          </svg>

          <span>{{'No'}}</span>
        </div>
      }
    </td> -->
    <td>
      <div class="d-flex justify-content-start gap-4 align-items-center w-100">
        <a class="edit-btn p-0" data-bs-toggle="tooltip" data-bs-placement="top" title="Edit"
          (click)="navigateToEdit(customField.id)">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
            viewBox="0 0 24 24"><!-- Icon from Solar by 480 Design - https://creativecommons.org/licenses/by/4.0/ -->
            <path fill="currentColor" fill-rule="evenodd"
              d="M11.943 1.25H13.5a.75.75 0 0 1 0 1.5H12c-2.378 0-4.086.002-5.386.176c-1.279.172-2.05.5-2.62 1.069c-.569.57-.896 1.34-1.068 2.619c-.174 1.3-.176 3.008-.176 5.386s.002 4.086.176 5.386c.172 1.279.5 2.05 1.069 2.62c.57.569 1.34.896 2.619 1.068c1.3.174 3.008.176 5.386.176s4.086-.002 5.386-.176c1.279-.172 2.05-.5 2.62-1.069c.569-.57.896-1.34 1.068-2.619c.174-1.3.176-3.008.176-5.386v-1.5a.75.75 0 0 1 1.5 0v1.557c0 2.309 0 4.118-.19 5.53c-.194 1.444-.6 2.584-1.494 3.479c-.895.895-2.035 1.3-3.48 1.494c-1.411.19-3.22.19-5.529.19h-.114c-2.309 0-4.118 0-5.53-.19c-1.444-.194-2.584-.6-3.479-1.494c-.895-.895-1.3-2.035-1.494-3.48c-.19-1.411-.19-3.22-.19-5.529v-.114c0-2.309 0-4.118.19-5.53c.194-1.444.6-2.584 1.494-3.479c.895-.895 2.035-1.3 3.48-1.494c1.411-.19 3.22-.19 5.529-.19m4.827 1.026a3.503 3.503 0 0 1 4.954 4.953l-6.648 6.649c-.371.37-.604.604-.863.806a5.3 5.3 0 0 1-.987.61c-.297.141-.61.245-1.107.411l-2.905.968a1.492 1.492 0 0 1-1.887-1.887l.968-2.905c.166-.498.27-.81.411-1.107q.252-.526.61-.987c.202-.26.435-.492.806-.863zm3.893 1.06a2.003 2.003 0 0 0-2.832 0l-.376.377q.032.145.098.338c.143.413.415.957.927 1.469a3.9 3.9 0 0 0 1.807 1.025l.376-.376a2.003 2.003 0 0 0 0-2.832m-1.558 4.391a5.4 5.4 0 0 1-1.686-1.146a5.4 5.4 0 0 1-1.146-1.686L11.218 9.95c-.417.417-.58.582-.72.76a4 4 0 0 0-.437.71c-.098.203-.172.423-.359.982l-.431 1.295l1.032 1.033l1.295-.432c.56-.187.779-.261.983-.358q.378-.18.71-.439c.177-.139.342-.302.759-.718z"
              clip-rule="evenodd" />
            </svg>
          </a>
          <!-- @if(!customField.pinned){ -->
          <a type="button" class="d-flex align-items-center gap-1"
            (click)="openToggleModal(customField.id, customField.is_active)"
            [ngClass]="customField.is_active ? 'remove-btn' : 'view-btn'">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
              <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"
                d="M12 2v4M8.5 3.706A9.003 9.003 0 0 0 12 21a9 9 0 0 0 3.5-17.294" />
              </svg>
              <span>{{ customField.is_active ? 'Deactivate' : 'Activate' }}</span>
            </a>
            <!-- }@else{
            <span>Unpin first</span>
            } -->

            <!-- <a class="edit-btn" data-bs-toggle="tooltip" data-bs-placement="top" title="Remove"
            (click)="openDeleteModal(customField.id)">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M5.66952 1.42113e-05H8.2056C8.3679 -8.93219e-05 8.50929 -0.000179489 8.64281 0.0211409C9.17028 0.10537 9.62673 0.43436 9.87344 0.908129C9.93588 1.02805 9.98051 1.16221 10.0317 1.31621L10.1154 1.56738C10.1296 1.6099 10.1337 1.62193 10.1371 1.63141C10.2684 1.9945 10.609 2.23995 10.995 2.24973C11.0051 2.24998 11.0175 2.25003 11.0626 2.25003H13.3126C13.6232 2.25003 13.8751 2.50187 13.8751 2.81253C13.8751 3.12319 13.6232 3.37503 13.3126 3.37503H0.5625C0.25184 3.37503 0 3.12319 0 2.81253C0 2.50187 0.25184 2.25003 0.5625 2.25003H2.81256C2.8576 2.25003 2.87003 2.24999 2.88017 2.24973C3.26616 2.23995 3.60668 1.99452 3.73802 1.63143C3.74147 1.62188 3.74544 1.61011 3.75968 1.56738L3.84339 1.31622C3.89461 1.16223 3.93924 1.02805 4.00169 0.90813C4.2484 0.434361 4.70485 0.10537 5.23232 0.0211409C5.36584 -0.000179489 5.50723 -8.93219e-05 5.66952 1.42113e-05ZM4.69361 2.25003C4.73225 2.17426 4.76648 2.09553 4.79593 2.01411C4.80487 1.98939 4.81365 1.96307 4.82492 1.92925L4.89977 1.70469C4.96815 1.49956 4.98389 1.45772 4.99951 1.42773C5.08174 1.26981 5.23389 1.16014 5.40972 1.13207C5.44311 1.12673 5.48777 1.12503 5.70401 1.12503H8.17112C8.38735 1.12503 8.43201 1.12673 8.46541 1.13207C8.64123 1.16014 8.79338 1.26981 8.87562 1.42773C8.89124 1.45772 8.90698 1.49955 8.97536 1.70469L9.05016 1.92912L9.0792 2.01413C9.10865 2.09554 9.14288 2.17427 9.18151 2.25003H4.69361Z"
                fill="#E04F5F" />
                <path
                  d="M2.37382 4.65011C2.35315 4.34014 2.08512 4.10561 1.77515 4.12627C1.46517 4.14694 1.23064 4.41497 1.25131 4.72495L1.5989 9.93875C1.66302 10.9008 1.71481 11.6779 1.83629 12.2877C1.96259 12.9217 2.17741 13.4512 2.6211 13.8663C3.0648 14.2814 3.60746 14.4606 4.24845 14.5444C4.86497 14.6251 5.64378 14.625 6.60795 14.625H7.26713C8.23129 14.625 9.01016 14.6251 9.62668 14.5444C10.2677 14.4606 10.8103 14.2814 11.254 13.8663C11.6977 13.4512 11.9125 12.9217 12.0388 12.2877C12.1603 11.6779 12.2121 10.9008 12.2762 9.93876L12.6238 4.72495C12.6445 4.41497 12.41 4.14694 12.1 4.12627C11.79 4.10561 11.522 4.34014 11.5013 4.65011L11.1564 9.82445C11.089 10.8353 11.0409 11.5387 10.9355 12.0679C10.8333 12.5813 10.6905 12.853 10.4854 13.0448C10.2804 13.2367 9.99976 13.361 9.48076 13.4289C8.94571 13.4989 8.24071 13.5 7.22757 13.5H6.64755C5.63442 13.5 4.92942 13.4989 4.39436 13.4289C3.87536 13.361 3.59474 13.2367 3.38968 13.0448C3.18462 12.853 3.04187 12.5812 2.93961 12.0679C2.83419 11.5387 2.78617 10.8353 2.71877 9.82445L2.37382 4.65011Z"
                  fill="#E04F5F" />
                  <path
                    d="M5.0066 6.00282C5.31572 5.97191 5.59136 6.19744 5.62228 6.50656L5.99728 10.2566C6.02819 10.5657 5.80266 10.8413 5.49354 10.8722C5.18442 10.9031 4.90877 10.6776 4.87786 10.3685L4.50286 6.6185C4.47195 6.30938 4.69748 6.03373 5.0066 6.00282Z"
                    fill="#E04F5F" />
                    <path
                      d="M8.86854 6.00282C9.17766 6.03373 9.40319 6.30938 9.37228 6.6185L8.99728 10.3685C8.96636 10.6776 8.69072 10.9031 8.3816 10.8722C8.07248 10.8413 7.84695 10.5657 7.87786 10.2566L8.25286 6.50656C8.28377 6.19744 8.55942 5.97191 8.86854 6.00282Z"
                      fill="#E04F5F" />
                    </svg>
                  </a> -->
                </div>
              </td>

            </ng-template>

            <ng-template #noCustomField>
              <tr>
                <td colspan="6" class="no-data py-4">
                  @if(searchTerm){
                    <ng-container>
                      No Custom field match your search.
                    </ng-container>
                  }
                  @else{
                  <ng-template>
                    No Custom field Added Yet.
                  </ng-template>
                }

              </td>
            </tr>
          </ng-template>
        </div>
      </div>


      <!-- Activate/Deactivate Modal -->
      <app-popup [title]="modalTitle" [paragraph1]="modalMessage" [paragraph2]="modalMessage2" [isOpen]="isActivateModalOpen"
        (close)="closeActivateModal()">
        <button modal-btn-left class="btn btn-lg w-100" [ngClass]="targetStatus ? 'btn-success' : 'btn-danger'"
          (click)="confirmToggleStatus()">
          @if(isLoading){
            <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
          } @else {
            @if(!targetStatus) {
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
                <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"
                  d="M12 2v4M8.5 3.706A9.003 9.003 0 0 0 12 21a9 9 0 0 0 3.5-17.294" />
                </svg>
              }
            }
            <span class="ms-2">{{ modalButtonText }}</span>
          </button>

          <button modal-btn-right class="btn btn-lg btn-outline-dark border-0 w-100" (click)="closeActivateModal()">
            Close
          </button>
        </app-popup>