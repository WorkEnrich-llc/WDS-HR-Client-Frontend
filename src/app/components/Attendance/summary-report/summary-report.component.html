<!-- start page header -->
<app-page-header [breadcrumbs]="[
    { label: 'Attendance', link: '/attendance' },
    { label: 'Attendace Summary Report' }
  ]" title="Attendace Summary Report">
</app-page-header>
<!-- end page header -->



<div class="content-hug">
  <div class="content-box d-flex flex-column gap-3">
    <!-- Filter Controls -->
    <form class="d-flex flex-column flex-lg-row align-items-center justify-content-between gap-2 mb-3"
      (ngSubmit)="onViewClick()">
      <div class="d-flex align-items-end gap-3 flex-nowrap w-100">
        <div class="form-outline w-100" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <label class="form-label">Year</label>
          <select class="form-select form-select-lg" [(ngModel)]="filterYear" name="filterYear">
            @for (year of yearOptions; track year) {
            <option [value]="year">{{ year }}</option>
            }
          </select>
        </div>
        <div class="form-outline w-100" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <label class="form-label">Month</label>
          <select class="form-select form-select-lg" [(ngModel)]="filterMonth" name="filterMonth">
            @for (month of monthOptions; track month) {
            <option [value]="month.value">{{ month.label }}</option>
            }
          </select>
        </div>
        <div class="form-outline w-100" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <label class="form-label">Employee Status</label>
          <select class="form-select form-select-lg" [(ngModel)]="filterStatus" name="filterStatus">
            <option value="">Select Status</option>
            @for (status of statusOptions; track status) {
            <option [value]="status.value">{{ status.label }}</option>
            }
          </select>
        </div>
        <div class="d-flex align-items-end gap-2" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <button type="submit" class="btn btn-primary btn-lg d-flex align-items-center gap-2 px-4 w-100">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M9 6.1875C7.4467 6.1875 6.1875 7.4467 6.1875 9C6.1875 10.5533 7.4467 11.8125 9 11.8125C10.5533 11.8125 11.8125 10.5533 11.8125 9C11.8125 7.4467 10.5533 6.1875 9 6.1875ZM7.3125 9C7.3125 8.06802 8.06802 7.3125 9 7.3125C9.93198 7.3125 10.6875 8.06802 10.6875 9C10.6875 9.93198 9.93198 10.6875 9 10.6875C8.06802 10.6875 7.3125 9.93198 7.3125 9Z"
                fill="#E0EBFF" />
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M9 2.4375C5.6144 2.4375 3.33397 4.46565 2.01043 6.18515L1.98656 6.21615C1.68723 6.6049 1.41155 6.96294 1.22452 7.3863C1.02423 7.83965 0.9375 8.33377 0.9375 9C0.9375 9.66623 1.02423 10.1603 1.22452 10.6137C1.41155 11.0371 1.68723 11.3951 1.98656 11.7839L2.01043 11.8149C3.33397 13.5344 5.6144 15.5625 9 15.5625C12.3856 15.5625 14.666 13.5344 15.9896 11.8149L16.0134 11.7839C16.3128 11.3951 16.5885 11.0371 16.7755 10.6137C16.9758 10.1603 17.0625 9.66623 17.0625 9C17.0625 8.33377 16.9758 7.83965 16.7755 7.3863C16.5885 6.96293 16.3128 6.60489 16.0134 6.21613L15.9896 6.18515C14.666 4.46565 12.3856 2.4375 9 2.4375ZM2.90191 6.87135C4.12398 5.28369 6.11277 3.5625 9 3.5625C11.8872 3.5625 13.876 5.28369 15.0981 6.87135C15.427 7.29869 15.6197 7.55404 15.7464 7.84091C15.8649 8.10901 15.9375 8.4367 15.9375 9C15.9375 9.5633 15.8649 9.89099 15.7464 10.1591C15.6197 10.446 15.427 10.7013 15.0981 11.1287C13.876 12.7163 11.8872 14.4375 9 14.4375C6.11277 14.4375 4.12398 12.7163 2.90191 11.1287C2.57298 10.7013 2.3803 10.446 2.25357 10.1591C2.13513 9.89099 2.0625 9.5633 2.0625 9C2.0625 8.4367 2.13513 8.10901 2.25357 7.84091C2.3803 7.55404 2.57298 7.29869 2.90191 6.87135Z"
                fill="#E0EBFF" />
            </svg>
            View
          </button>
        </div>
        <div class="d-flex align-items-end gap-2" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <button type="button" class="btn btn-outline-primary btn-lg d-flex align-items-center gap-2 px-4 w-100"
            (click)="onPrintClick()">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
              <g fill="none">
                <path stroke="currentColor" stroke-width="1.5"
                  d="M6 17.983c-1.553-.047-2.48-.22-3.121-.862C2 16.243 2 14.828 2 12s0-4.243.879-5.121C3.757 6 5.172 6 8 6h8c2.828 0 4.243 0 5.121.879C22 7.757 22 9.172 22 12s0 4.243-.879 5.121c-.641.642-1.567.815-3.121.862" />
                <path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M9 10H6m13 5H5" />
                <path fill="currentColor"
                  d="m17.121 2.879l-.53.53zm-10.242 0l.53.53zm0 18.242l.53-.53zM18.75 15a.75.75 0 0 0-1.5 0zm-12 0a.75.75 0 0 0-1.5 0zm10.5 1c0 1.435-.002 2.436-.103 3.192c-.099.734-.28 1.122-.556 1.399l1.06 1.06c.603-.601.861-1.36.983-2.26c.118-.878.116-1.998.116-3.391zM12 22.75c1.393 0 2.513.002 3.392-.116c.9-.122 1.658-.38 2.26-.982L16.59 20.59c-.277.277-.665.457-1.4.556c-.755.101-1.756.103-3.191.103zm0-20c1.435 0 2.437.002 3.192.103c.734.099 1.122.28 1.399.556l1.06-1.06c-.601-.603-1.36-.861-2.26-.982c-.878-.119-1.998-.117-3.391-.117zm0-1.5c-1.393 0-2.513-.002-3.392.117c-.9.12-1.658.38-2.26.981L7.41 3.41c.277-.277.665-.457 1.4-.556c.754-.101 1.756-.103 3.191-.103zM5.25 16c0 1.393-.002 2.513.117 3.392c.12.9.38 1.658.981 2.26L7.41 20.59c-.277-.277-.457-.665-.556-1.4c-.101-.755-.103-1.756-.103-3.191zM12 21.25c-1.435 0-2.437-.002-3.192-.103c-.734-.099-1.122-.28-1.399-.556l-1.06 1.06c.601.603 1.36.861 2.26.983c.878.118 1.998.116 3.391.116zm6.732-15.273c-.046-1.542-.208-2.757-1.08-3.629L16.59 3.41c.41.41.595 1.049.642 2.614zm-11.965.046c.047-1.565.231-2.203.642-2.614l-1.06-1.06c-.873.871-1.035 2.086-1.081 3.628zM18.75 16v-1h-1.5v1zm-12 0v-1h-1.5v1z" />
                <circle cx="17" cy="10" r="1" fill="currentColor" />
              </g>
            </svg>
            Print
          </button>
        </div>
      </div>
    </form>
    <ng-template #headerTemplate>
      <th>Employee</th>
      <th>Employment Type</th>
      <th>Working Days</th>
      <th>Absense</th>
      <th>Lateness</th>
      <th>Early Leave</th>
      <th>Total Deductions</th>
    </ng-template>
    <ng-template #rowTemplate let-item>
      <td>
        <span class="d-block text-gray-sm">{{ item.employee.id?.toString().padStart(4, '0') }}</span>
        <span class="d-block text-truncate" style="max-width: 220px">{{ item.employee.name }}</span>
      </td>
      <td>{{ item.employment_type }}</td>
      <td>{{ item.working_days }}</td>
      <td>{{ item.absense }}</td>
      <td>{{ item.lateness }}</td>
      <td>{{ item.early_leave }}</td>
      <td>{{ item.total }}</td>
    </ng-template>
    <ng-template #emptyTemplate>
      <tr>
        <td colspan="7" class="text-center">No data available.</td>
      </tr>
    </ng-template>
    <app-table [data]="summaryReportData?.data?.object_info?.list_items || []" [isLoading]="loading"
      [totalItems]="summaryReportData?.data?.object_info?.total_items || 0" [itemsPerPage]="itemsPerPage"
      [currentPage]="summaryReportData?.data?.object_info?.page || 1" [columnsCount]="7"
      (pageChange)="onPageChange($event)" (itemsPerPageChange)="onItemsPerPageChange($event)"
      [disablePagination]="false" [headerTemplate]="headerTemplate" [rowTemplate]="rowTemplate"
      [emptyTemplate]="emptyTemplate">
    </app-table>
  </div>
</div>