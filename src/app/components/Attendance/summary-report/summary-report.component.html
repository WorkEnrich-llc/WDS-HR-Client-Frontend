<!-- start page header -->
<app-page-header [breadcrumbs]="[
    { label: 'Attendance', link: '/attendance' },
    { label: 'Attendace Summary Report' }
  ]" title="Attendace Summary Report">
</app-page-header>
<!-- end page header -->



<div class="content-hug">
  <div class="content-box d-flex flex-column gap-3">
    <!-- Filter Controls -->
    <form class="d-flex flex-column flex-lg-row align-items-center justify-content-between gap-2 mb-3">
      <div class="d-flex align-items-end gap-3 flex-nowrap w-100">
        <div class="form-outline w-100" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <label class="form-label">Year</label>
          <select class="form-select form-select-lg" [(ngModel)]="filterYear" name="filterYear" (change)="onFilterChange()">
            @for (year of yearOptions; track year) {
            <option [value]="year">{{ year }}</option>
            }
          </select>
        </div>
        <div class="form-outline w-100" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <label class="form-label">Month</label>
          <select class="form-select form-select-lg" [(ngModel)]="filterMonth" name="filterMonth" (change)="onFilterChange()">
            @for (month of monthOptions; track month) {
            <option [value]="month.value">{{ month.label }}</option>
            }
          </select>
        </div>
        <div class="form-outline w-100" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <label class="form-label">Employee Status</label>
          <select class="form-select form-select-lg" [(ngModel)]="filterStatus" name="filterStatus" (change)="onFilterChange()">
            <option value="">Select Status</option>
            @for (status of statusOptions; track status) {
            <option [value]="status.value">{{ status.label }}</option>
            }
          </select>
        </div>
        <div class="d-flex align-items-end gap-2" style="flex: 1 1 20%; max-width: 20%; min-width: 180px;">
          <button type="button" class="btn btn-outline-primary btn-lg d-flex align-items-center gap-2 px-4 w-100"
            (click)="onPrintClick()">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
              <g fill="none">
                <path stroke="currentColor" stroke-width="1.5"
                  d="M6 17.983c-1.553-.047-2.48-.22-3.121-.862C2 16.243 2 14.828 2 12s0-4.243.879-5.121C3.757 6 5.172 6 8 6h8c2.828 0 4.243 0 5.121.879C22 7.757 22 9.172 22 12s0 4.243-.879 5.121c-.641.642-1.567.815-3.121.862" />
                <path stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M9 10H6m13 5H5" />
                <path fill="currentColor"
                  d="m17.121 2.879l-.53.53zm-10.242 0l.53.53zm0 18.242l.53-.53zM18.75 15a.75.75 0 0 0-1.5 0zm-12 0a.75.75 0 0 0-1.5 0zm10.5 1c0 1.435-.002 2.436-.103 3.192c-.099.734-.28 1.122-.556 1.399l1.06 1.06c.603-.601.861-1.36.983-2.26c.118-.878.116-1.998.116-3.391zM12 22.75c1.393 0 2.513.002 3.392-.116c.9-.122 1.658-.38 2.26-.982L16.59 20.59c-.277.277-.665.457-1.4.556c-.755.101-1.756.103-3.191.103zm0-20c1.435 0 2.437.002 3.192.103c.734.099 1.122.28 1.399.556l1.06-1.06c-.601-.603-1.36-.861-2.26-.982c-.878-.119-1.998-.117-3.391-.117zm0-1.5c-1.393 0-2.513-.002-3.392.117c-.9.12-1.658.38-2.26.981L7.41 3.41c.277-.277.665-.457 1.4-.556c.754-.101 1.756-.103 3.191-.103zM5.25 16c0 1.393-.002 2.513.117 3.392c.12.9.38 1.658.981 2.26L7.41 20.59c-.277-.277-.457-.665-.556-1.4c-.101-.755-.103-1.756-.103-3.191zM12 21.25c-1.435 0-2.437-.002-3.192-.103c-.734-.099-1.122-.28-1.399-.556l-1.06 1.06c.601.603 1.36.861 2.26.983c.878.118 1.998.116 3.391.116zm6.732-15.273c-.046-1.542-.208-2.757-1.08-3.629L16.59 3.41c.41.41.595 1.049.642 2.614zm-11.965.046c.047-1.565.231-2.203.642-2.614l-1.06-1.06c-.873.871-1.035 2.086-1.081 3.628zM18.75 16v-1h-1.5v1zm-12 0v-1h-1.5v1z" />
                <circle cx="17" cy="10" r="1" fill="currentColor" />
              </g>
            </svg>
            Print
          </button>
        </div>
      </div>
    </form>
    <ng-template #headerTemplate>
      <th>Employee</th>
      <th>Employment Type</th>
      <th>Working Days</th>
      <th>Absense</th>
      <th>Lateness</th>
      <th>Early Leave</th>
      <th>Total Deductions</th>
    </ng-template>
    <ng-template #rowTemplate let-item>
      <td>
        <span class="d-block text-gray-sm">{{ item.employee.id?.toString().padStart(4, '0') }}</span>
        <span class="d-block text-truncate" style="max-width: 220px">{{ item.employee.name }}</span>
      </td>
      <td>{{ item.employment_type }}</td>
      <td>{{ item.working_days }}</td>
      <td>{{ item.absense }}</td>
      <td>{{ item.lateness }}</td>
      <td>{{ item.early_leave }}</td>
      <td>{{ item.total }}</td>
    </ng-template>
    <ng-template #emptyTemplate>
      <tr>
        <td colspan="7" class="text-center">No data available.</td>
      </tr>
    </ng-template>
    <app-table [data]="summaryReportData?.data?.object_info?.list_items || []" [isLoading]="loading"
      [totalItems]="summaryReportData?.data?.object_info?.total_items || 0" [itemsPerPage]="itemsPerPage"
      [currentPage]="summaryReportData?.data?.object_info?.page || 1" [columnsCount]="7"
      (pageChange)="onPageChange($event)" (itemsPerPageChange)="onItemsPerPageChange($event)"
      [disablePagination]="false" [headerTemplate]="headerTemplate" [rowTemplate]="rowTemplate"
      [emptyTemplate]="emptyTemplate">
    </app-table>
  </div>
</div>