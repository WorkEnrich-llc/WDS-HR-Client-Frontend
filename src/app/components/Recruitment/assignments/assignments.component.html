<!-- start page header -->
<app-page-header [breadcrumbs]="[
    { label: 'Recruitment', link: '/calendar' },
    { label: 'Assignments' }
  ]" title="All Assignments">
</app-page-header>
<!-- end page header -->
<!-- start page content -->
<div class="content-hug">
    <div class="content-box d-flex flex-column gap-3">
        <!-- start search and filter -->
        <div
            class="d-flex flex-column flex-lg-row align-items-start align-lg-items-center justify-content-between gap-2">
            <div class="d-flex align-items-center gap-2 w-50 w-lg-50">
                <!-- Search input -->
                <div data-mdb-input-init class="form-outline w-75">
                    <input type="text" class="form-control" placeholder="Search" [(ngModel)]="searchQuery"
                        (input)="onSearchChange()" />
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                        <g fill="none" stroke-width="1.5">
                            <circle cx="11.5" cy="11.5" r="9.5" />
                            <path stroke-linecap="round" d="M18.5 18.5L22 22" />
                        </g>
                    </svg>
                </div>
            </div>
            <button class="btn btn-lg btn-primary" [routerLink]="['/assignments/add']">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24">
                    <g fill="none" stroke="#ffffff" stroke-width="1.5">
                        <circle cx="12" cy="12" r="10" />
                        <path stroke-linecap="round" d="M15 12h-3m0 0H9m3 0V9m0 3v3" />
                    </g>
                </svg>
                <span>New Assignment</span>
            </button>
        </div>
        <!-- end search and filter -->

        <!-- start Table -->
        <app-table [data]="assignments" [isLoading]="isLoading" [columnsCount]="5" [totalItems]="totalCount"
            [itemsPerPage]="pageSize" [currentPage]="currentPage" (pageChange)="onPageChange($event)"
            (itemsPerPageChange)="onItemsPerPageChange($event)" [headerTemplate]="assignmentTableHeader"
            [rowTemplate]="assignmentTableRow" [emptyTemplate]="noAssignments"></app-table>
        <!-- end Table -->

        <!-- Table Header Template -->
        <ng-template #assignmentTableHeader>
            <th class="w-20 text-start">Assignment</th>
            <th class="w-20 text-start">Questions</th>
            <th class="w-20 text-start">Total Score</th>
            <th class="w-20 text-start">Created at</th>
            <th class="text-start">Actions</th>
        </ng-template>

        <!-- Table Row Template -->
        <ng-template #assignmentTableRow let-assignment>
            <td class="text-start">
                <span class="d-block text-gray-sm mb-2">{{ assignment.id }}</span>
                <span class="d-block text-truncate fw-bold" style="max-width: 300px">
                    {{ assignment.title || assignment.name }}
                </span>
            </td>
            <td class="text-start">
                {{ assignment.questions?.length ?? assignment.num_questions ?? assignment.question_count ?? '-' }}
            </td>
            <td class="text-start">
                {{ assignment.total_score ?? assignment.score ?? assignment.marks ?? '-' }}
            </td>
            <td class="text-start">
                <span class="text-gray-sm">{{ assignment.created_at | date: 'dd/MM/yyyy' }}</span>
            </td>
            <td>
                <div class="d-flex justify-content-start gap-5 align-items-center w-100">
                    <a (click)="navigateToView(assignment.id)"
                        class="view-btn h-100 d-flex align-items-center gap-1 w-auto me-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="17" height="14" viewBox="0 0 17 14" fill="none">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M8.0625 3.75C6.5092 3.75 5.25 5.0092 5.25 6.5625C5.25 8.1158 6.5092 9.375 8.0625 9.375C9.6158 9.375 10.875 8.1158 10.875 6.5625C10.875 5.0092 9.6158 3.75 8.0625 3.75ZM6.375 6.5625C6.375 5.63052 7.13052 4.875 8.0625 4.875C8.99448 4.875 9.75 5.63052 9.75 6.5625C9.75 7.49448 8.99448 8.25 8.0625 8.25C7.13052 8.25 6.375 7.49448 6.375 6.5625Z"
                                fill="#377AFD" />
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M8.0625 0C4.6769 0 2.39647 2.02815 1.07293 3.74765L1.04906 3.77865C0.749729 4.1674 0.474045 4.52544 0.287015 4.9488C0.0867334 5.40215 0 5.89627 0 6.5625C0 7.22873 0.0867334 7.72285 0.287015 8.1762C0.474046 8.59956 0.749731 8.9576 1.04906 9.34636L1.07293 9.37735C2.39647 11.0969 4.6769 13.125 8.0625 13.125C11.4481 13.125 13.7285 11.0969 15.0521 9.37735L15.0759 9.34637C15.3753 8.95761 15.651 8.59957 15.838 8.1762C16.0383 7.72285 16.125 7.22873 16.125 6.5625C16.125 5.89627 16.0383 5.40215 15.838 4.9488C15.651 4.52543 15.3753 4.16739 15.0759 3.77863L15.0521 3.74765C13.7285 2.02815 11.4481 0 8.0625 0ZM1.96441 4.43385C3.18648 2.84619 5.17527 1.125 8.0625 1.125C10.9497 1.125 12.9385 2.84619 14.1606 4.43385C14.4895 4.86119 14.6822 5.11654 14.8089 5.40341C14.9274 5.67151 15 5.9992 15 6.5625C15 7.1258 14.9274 7.45349 14.8089 7.72159C14.6822 8.00846 14.4895 8.26381 14.1606 8.69115C12.9385 10.2788 10.9497 12 8.0625 12C5.17527 12 3.18648 10.2788 1.96441 8.69115C1.63548 8.26381 1.4428 8.00846 1.31607 7.72159C1.19763 7.45349 1.125 7.1258 1.125 6.5625C1.125 5.9992 1.19763 5.67151 1.31607 5.40341C1.4428 5.11654 1.63548 4.86119 1.96441 4.43385Z"
                                fill="#377AFD" />
                        </svg>
                        <span>View</span>
                    </a>
                    <a (click)="navigateToEdit(assignment.id)"
                        class="edit-btn h-100 d-flex align-items-center gap-1 w-auto cursor-pointer"
                        data-bs-toggle="tooltip" data-bs-placement="top" title="Edit">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                            <g clip-path="url(#clip0_1618_29112)">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M8.95697 0.9375L10.125 0.9375C10.4357 0.9375 10.6875 1.18934 10.6875 1.5C10.6875 1.81066 10.4357 2.0625 10.125 2.0625H9C7.21633 2.0625 5.93517 2.06369 4.96018 2.19478C4.00138 2.32369 3.42334 2.56886 2.9961 2.9961C2.56886 3.42334 2.32369 4.00138 2.19478 4.96018C2.06369 5.93517 2.0625 7.21633 2.0625 9C2.0625 10.7837 2.06369 12.0648 2.19478 13.0398C2.32369 13.9986 2.56886 14.5767 2.9961 15.0039C3.42334 15.4311 4.00138 15.6763 4.96018 15.8052C5.93517 15.9363 7.21633 15.9375 9 15.9375C10.7837 15.9375 12.0648 15.9363 13.0398 15.8052C13.9986 15.6763 14.5767 15.4311 15.0039 15.0039C15.4311 14.5767 15.6763 13.9986 15.8052 13.0398C15.9363 12.0648 15.9375 10.7837 15.9375 9V7.875C15.9375 7.56434 16.1893 7.3125 16.5 7.3125C16.8107 7.3125 17.0625 7.56434 17.0625 7.875V9.04303C17.0625 10.7743 17.0625 12.1311 16.9202 13.1897C16.7745 14.2733 16.4705 15.1283 15.7994 15.7994C15.1283 16.4705 14.2733 16.7745 13.1897 16.9202C12.1311 17.0625 10.7743 17.0625 9.04303 17.0625H8.95697C7.22567 17.0625 5.8689 17.0625 4.81028 16.9202C3.72673 16.7745 2.87171 16.4705 2.2006 15.7994C1.5295 15.1283 1.22549 14.2733 1.07981 13.1897C0.937483 12.1311 0.937491 10.7743 0.9375 9.04303V8.95697C0.937491 7.22567 0.937483 5.86889 1.07981 4.81028C1.22549 3.72673 1.5295 2.87171 2.2006 2.2006C2.87171 1.5295 3.72673 1.22549 4.81028 1.07981C5.86889 0.937483 7.22567 0.937491 8.95697 0.9375ZM12.5779 1.70694C13.6038 0.681022 15.2671 0.681022 16.2931 1.70694C17.319 2.73285 17.319 4.39619 16.2931 5.4221L11.307 10.4082C11.0285 10.6867 10.8541 10.8611 10.6594 11.013C10.4302 11.1918 10.1821 11.3451 9.91961 11.4702C9.69676 11.5764 9.46271 11.6544 9.08909 11.7789L6.9107 12.505C6.50851 12.6391 6.0651 12.5344 5.76533 12.2347C5.46556 11.9349 5.36089 11.4915 5.49495 11.0893L6.22108 8.91092C6.34559 8.53729 6.42359 8.30324 6.5298 8.08039C6.65489 7.81791 6.80821 7.56984 6.98703 7.34056C7.13887 7.1459 7.31333 6.97147 7.59183 6.693L12.5779 1.70694ZM15.4976 2.50243C14.911 1.91586 13.96 1.91586 13.3734 2.50243L13.0909 2.7849C13.108 2.85679 13.1318 2.94245 13.1649 3.038C13.2724 3.34779 13.4758 3.75579 13.86 4.14C14.2442 4.5242 14.6522 4.7276 14.962 4.83508C15.0575 4.86823 15.1432 4.89205 15.2151 4.90907L15.4976 4.62661C16.0841 4.04003 16.0841 3.08901 15.4976 2.50243ZM14.3289 5.79532C13.9419 5.6289 13.4911 5.36209 13.0645 4.93549C12.6379 4.50889 12.3711 4.05812 12.2047 3.67114L8.41313 7.46269C8.10075 7.77508 7.97823 7.89897 7.87411 8.03246C7.74553 8.19731 7.6353 8.37567 7.54536 8.56439C7.47252 8.71722 7.41651 8.8822 7.2768 9.30131L6.95288 10.2731L7.72693 11.0471L8.69869 10.7232C9.1178 10.5835 9.28278 10.5275 9.43561 10.4546C9.62433 10.3647 9.80269 10.2545 9.96754 10.1259C10.101 10.0218 10.2249 9.89926 10.5373 9.58687L14.3289 5.79532Z"
                                    fill="#4A6D97" />
                            </g>
                            <defs>
                                <clipPath id="clip0_1618_29112">
                                    <rect width="18" height="18" fill="white" />
                                </clipPath>
                            </defs>
                        </svg>
                        <span>Edit</span>
                    </a>
                </div>
            </td>
        </ng-template>

        <!-- Empty State Template -->
        <ng-template #noAssignments>
            <tr>
                <td colspan="5" class="text-center py-5">
                    <span class="text-muted">No assignments available yet.</span>
                </td>
            </tr>
        </ng-template>
    </div>
</div>
<!-- end page content -->