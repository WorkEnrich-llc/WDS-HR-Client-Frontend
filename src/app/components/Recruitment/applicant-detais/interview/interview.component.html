<div class="content-box d-flex flex-column gap-3 w-100 h-100">
  <div class="d-flex align-items-center justify-content-between">
    <h2>Current Status</h2>
    <div>
      @if (isStatus('Applicant')) {
      <div class="badge-gray">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <path fill="currentColor" fill-rule="evenodd"
            d="M12 1.25a4.75 4.75 0 1 0 0 9.5a4.75 4.75 0 0 0 0-9.5M8.75 6a3.25 3.25 0 1 1 6.5 0a3.25 3.25 0 0 1-6.5 0M12 12.25c-2.04 0-3.922.47-5.322 1.27C5.3 14.308 4.25 15.51 4.25 17s1.05 2.692 2.428 3.48c1.4.8 3.283 1.27 5.322 1.27s3.922-.47 5.322-1.27c1.378-.788 2.428-1.99 2.428-3.48s-1.05-2.692-2.428-3.48c-1.4-.8-3.283-1.27-5.322-1.27M5.75 17c0-.72.517-1.517 1.672-2.177c1.134-.648 2.751-1.073 4.578-1.073s3.444.425 4.578 1.073c1.155.66 1.672 1.458 1.672 2.177s-.517 1.517-1.672 2.177c-1.134.648-2.751 1.073-4.578 1.073s-3.444-.425-4.578-1.073C6.267 18.517 5.75 17.72 5.75 17"
            clip-rule="evenodd" />
        </svg>
        <span>Applicant</span>
      </div>
      }
      @if (isStatus('Candidate')) {
      <div class="badge-newjoiner">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <path fill="currentColor" fill-rule="evenodd"
            d="M12 1.25a4.75 4.75 0 1 0 0 9.5a4.75 4.75 0 0 0 0-9.5M8.75 6a3.25 3.25 0 1 1 6.5 0a3.25 3.25 0 0 1-6.5 0"
            clip-rule="evenodd" />
          <path fill="currentColor"
            d="M18.856 16.573a.75.75 0 0 1 .015 1.06l-1.833 1.89a.75.75 0 0 1-1.114-.043l-.834-1a.75.75 0 1 1 1.153-.96l.3.36l1.252-1.291a.75.75 0 0 1 1.06-.016" />
          <path fill="currentColor" fill-rule="evenodd"
            d="M13.91 21.608c-.61.093-1.251.142-1.91.142c-2.04 0-3.922-.47-5.322-1.27C5.3 19.692 4.25 18.49 4.25 17s1.05-2.692 2.428-3.48c1.4-.8 3.283-1.27 5.322-1.27c1.805 0 3.483.368 4.812 1.004q.093-.004.188-.004a4.75 4.75 0 1 1-3.09 8.358M13.75 18a3.25 3.25 0 1 1 6.5 0a3.25 3.25 0 0 1-6.5 0m.668-3.987A4.75 4.75 0 0 0 12.25 18c0 .803.2 1.56.55 2.222q-.393.028-.8.028c-1.827 0-3.444-.425-4.578-1.073C6.267 18.517 5.75 17.72 5.75 17s.517-1.517 1.672-2.177c1.134-.648 2.751-1.073 4.578-1.073c.861 0 1.677.094 2.418.263"
            clip-rule="evenodd" />
        </svg>
        <span>Candidate</span>
      </div>
      }
      @if (isStatus('Interviewee')) {
      <div class="badge-newemployee">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <g fill="none" stroke="currentColor" stroke-width="1.5">
            <path
              d="M2 12c0-3.771 0-5.657 1.172-6.828S6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172S22 8.229 22 12v2c0 3.771 0 5.657-1.172 6.828S17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.172S2 17.771 2 14z" />
            <path stroke-linecap="round" d="M7 4V2.5M17 4V2.5" />
            <circle cx="16.5" cy="16.5" r="1.5" />
            <path stroke-linecap="round" d="M2.5 9h19" />
          </g>
        </svg>
        <span>Interviewee</span>
      </div>
      }
      @if (isStatus('Job Offer Sent')) {
      <div class="badge-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <path fill="currentColor" fill-rule="evenodd"
            d="M18.144 3.63c-1.17.209-2.748.733-4.961 1.47L8.17 6.77c-1.78.594-3.069 1.025-3.98 1.412c-.952.405-1.29.687-1.4.876a1.88 1.88 0 0 0 0 1.886c.11.189.448.471 1.4.876c.911.387 2.2.818 3.98 1.411l.084.028c.38.126.693.23.967.374l5.323-5.265a.768.768 0 1 1 1.08 1.093l-5.3 5.241c.166.292.278.628.416 1.043l.028.084c.593 1.78 1.024 3.069 1.41 3.98c.406.952.688 1.29.877 1.4a1.88 1.88 0 0 0 1.886 0c.189-.11.471-.448.876-1.4c.387-.911.818-2.2 1.411-3.98l1.67-5.012c.738-2.213 1.262-3.79 1.47-4.96c.21-1.176.05-1.676-.25-1.976s-.8-.46-1.975-.25m-.27-1.512c1.303-.232 2.476-.179 3.331.677c.856.855.909 2.028.677 3.33c-.23 1.295-.792 2.98-1.503 5.112l-1.705 5.115c-.578 1.735-1.027 3.083-1.442 4.058c-.4.94-.844 1.736-1.518 2.128a3.41 3.41 0 0 1-3.43 0c-.674-.392-1.118-1.188-1.518-2.128c-.415-.975-.864-2.323-1.443-4.058l-.012-.038c-.203-.607-.264-.772-.352-.903a1.4 1.4 0 0 0-.37-.37c-.13-.088-.296-.15-.904-.352l-.037-.012c-1.735-.579-3.083-1.028-4.058-1.443c-.94-.4-1.736-.844-2.128-1.518a3.41 3.41 0 0 1 0-3.43c.392-.674 1.188-1.118 2.128-1.518c.975-.415 2.323-.864 4.059-1.442l5.114-1.705c2.133-.711 3.817-1.273 5.112-1.503"
            clip-rule="evenodd" />
        </svg>
        <span>Job Offer Sent</span>
      </div>
      }
      @if (isStatus('New Joiner')) {
      <div class="badge-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M16.03 10.03a.75.75 0 1 0-1.06-1.06l-4.47 4.47l-1.47-1.47a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0z" />
          <path fill="currentColor" fill-rule="evenodd"
            d="M12 1.25C6.063 1.25 1.25 6.063 1.25 12S6.063 22.75 12 22.75S22.75 17.937 22.75 12S17.937 1.25 12 1.25M2.75 12a9.25 9.25 0 1 1 18.5 0a9.25 9.25 0 0 1-18.5 0"
            clip-rule="evenodd" />
        </svg>
        <span>New Joiner</span>
      </div>
      }
      @if (isStatus('Rejected')) {
      <div class="badge-danger">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <path fill="currentColor" fill-rule="evenodd"
            d="M10.03 8.97a.75.75 0 0 0-1.06 1.06L10.94 12l-1.97 1.97a.75.75 0 1 0 1.06 1.06L12 13.06l1.97 1.97a.75.75 0 0 0 1.06-1.06L13.06 12l1.97-1.97a.75.75 0 1 0-1.06-1.06L12 10.94z" />
          <path fill="currentColor" fill-rule="evenodd"
            d="M12 1.25C6.063 1.25 1.25 6.063 1.25 12S6.063 22.75 12 22.75S22.75 17.937 22.75 12S17.937 1.25 12 1.25M2.75 12a9.25 9.25 0 1 1 18.5 0a9.25 9.25 0 0 1-18.5 0"
            clip-rule="evenodd" />
        </svg>
        <span>Rejected</span>
      </div>
      }
      @if (isStatus('Not Selected')) {
      <div class="badge-gray">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <path fill="currentColor" fill-rule="evenodd"
            d="M12 1.25a4.75 4.75 0 1 0 0 9.5a4.75 4.75 0 0 0 0-9.5M8.75 6a3.25 3.25 0 1 1 6.5 0a3.25 3.25 0 0 1-6.5 0M12 12.25c-2.04 0-3.922.47-5.322 1.27C5.3 14.308 4.25 15.51 4.25 17s1.05 2.692 2.428 3.48c1.4.8 3.283 1.27 5.322 1.27s3.922-.47 5.322-1.27c1.378-.788 2.428-1.99 2.428-3.48s-1.05-2.692-2.428-3.48c-1.4-.8-3.283-1.27-5.322-1.27"
            clip-rule="evenodd" />
        </svg>
        <span>Not Selected</span>
      </div>
      }
      @if (isStatus('Accepted')) {
      <div class="badge-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
          <path fill="currentColor"
            d="M16.03 10.03a.75.75 0 1 0-1.06-1.06l-4.47 4.47l-1.47-1.47a.75.75 0 0 0-1.06 1.06l2 2a.75.75 0 0 0 1.06 0z" />
          <path fill="currentColor" fill-rule="evenodd"
            d="M12 1.25C6.063 1.25 1.25 6.063 1.25 12S6.063 22.75 12 22.75S22.75 17.937 22.75 12S17.937 1.25 12 1.25M2.75 12a9.25 9.25 0 1 1 18.5 0a9.25 9.25 0 0 1-18.5 0"
            clip-rule="evenodd" />
        </svg>
        <span>New Joiner</span>
      </div>
      }
    </div>
  </div>

  @if (isStatus('Applicant')) {
  <button class="btn btn-primary btn-lg w-100" (click)="addAsCandidate()" [disabled]="submitting || !applicationId">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
      <g fill="none" stroke="currentColor" stroke-width="1.5">
        <circle cx="12" cy="6" r="4" />
        <circle cx="17" cy="18" r="4" />
        <path stroke-linecap="round" stroke-linejoin="round" d="m15.667 18l.833 1l1.833-1.889" />
        <path d="M14 20.834c-.634.108-1.305.166-2 .166c-3.866 0-7-1.79-7-4s3.134-4 7-4c1.713 0 3.283.352 4.5.936" />
      </g>
    </svg>
    <span>Add as Candidate</span>
  </button>
  }

  @if (isStatus('Candidate')) {
  <button class="btn btn-primary btn-lg w-100" (click)="openInterviewOverlay()">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
      <g fill="none" stroke="currentColor" stroke-width="1.5">
        <path
          d="M2 12c0-3.771 0-5.657 1.172-6.828S6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172S22 8.229 22 12v2c0 3.771 0 5.657-1.172 6.828S17.771 22 14 22h-4c-3.771 0-5.657 0-6.828-1.172S2 17.771 2 14z" />
        <path stroke-linecap="round" d="M18 16h-2m0 0h-2m2 0v-2m0 2v2M7 4V2.5M17 4V2.5M2.5 9h19" />
      </g>
    </svg>
    <span>Interview</span>
  </button>
  }

  @if (isStatus('Interviewee')) {
  <div class="d-flex align-items-center justify-content-between gap-3">
    <button class="btn btn-outline-primary btn-lg w-100" (click)="openRescheduleOverlay()">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
        <path fill="currentColor"
          d="M18.258 3.508a.75.75 0 0 1 .463.693v4.243a.75.75 0 0 1-.75.75h-4.243a.75.75 0 0 1-.53-1.28L14.8 6.31a7.25 7.25 0 1 0 4.393 5.783a.75.75 0 0 1 1.488-.187A8.75 8.75 0 1 1 15.93 5.18l1.51-1.51a.75.75 0 0 1 .817-.162" />
      </svg>
      <span>Reschedule Interview</span>
    </button>
    <button class="btn btn-success btn-lg w-100 d-flex align-items-center justify-content-center gap-2"
      (click)="markQualified()">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
        <path fill="currentColor" d="M9.5 16.5l-4-4 1.41-1.41L9.5 13.67l7.09-7.09L18 8l-8.5 8.5z" />
      </svg>
      <span>Qualified</span>
    </button>
  </div>
  }

  @if (isStatus('Qualified')) {
  <button class="btn btn-success btn-lg w-100 d-flex align-items-center justify-content-center gap-2"
    (click)="openJobOfferOverlay()">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
      <path fill="currentColor" fill-rule="evenodd"
        d="M18.144 3.63c-1.17.209-2.748.733-4.961 1.47L8.17 6.77c-1.78.594-3.069 1.025-3.98 1.412c-.952.405-1.29.687-1.4.876a1.88 1.88 0 0 0 0 1.886c.11.189.448.471 1.4.876c.911.387 2.2.818 3.98 1.411l.084.028c.38.126.693.23.967.374l5.323-5.265a.768.768 0 1 1 1.08 1.093l-5.3 5.241c.166.292.278.628.416 1.043l.028.084c.593 1.78 1.024 3.069 1.41 3.98c.406.952.688 1.29.877 1.4a1.88 1.88 0 0 0 1.886 0c.189-.11.471-.448.876-1.4c.387-.911.818-2.2 1.411-3.98l1.67-5.012c.738-2.213 1.262-3.79 1.47-4.96c.21-1.176.05-1.676-.25-1.976s-.8-.46-1.975-.25m-.27-1.512c1.303-.232 2.476-.179 3.331.677c.856.855.909 2.028.677 3.33c-.23 1.295-.792 2.98-1.503 5.112l-1.705 5.115c-.578 1.735-1.027 3.083-1.442 4.058c-.4.94-.844 1.736-1.518 2.128a3.41 3.41 0 0 1-3.43 0c-.674-.392-1.118-1.188-1.518-2.128c-.415-.975-.864-2.323-1.443-4.058l-.012-.038c-.203-.607-.264-.772-.352-.903a1.4 1.4 0 0 0-.37-.37c-.13-.088-.296-.15-.904-.352l-.037-.012c-1.735-.579-3.083-1.028-4.058-1.443c-.94-.4-1.736-.844-2.128-1.518a3.41 3.41 0 0 1 0-3.43c.392-.674 1.188-1.118 2.128-1.518c.975-.415 2.323-.864 4.059-1.442l5.114-1.705c2.133-.711 3.817-1.273 5.112-1.503" />
    </svg>
    <span>Job Offer</span>
  </button>
  }

  <!-- Show Revert button if Rejected -->
  @if (isStatus('Rejected')) {
  <button class="btn btn-primary btn-lg w-100" (click)="revertToCandidate()">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M3.5 12a8.5 8.5 0 0 1 15.262-3.5H14a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 .75-.75V3a.75.75 0 0 0-1.5 0v4.262A10 10 0 1 0 21 12a.75.75 0 0 0-1.5 0A8.5 8.5 0 0 1 3.5 12Z" />
    </svg>
    <span>Revert to Candidate</span>
  </button>
  }

  <!-- Hide all actions if Not Selected or Qualified -->
  @if (isStatus('Not Selected') || isStatus('Qualified')) {
  <ng-container></ng-container>
  }

  <!-- Revert to Candidate confirmation popup -->
  <app-popup [title]="'Revert to Candidate'"
    [paragraph1]="'Are you sure you want to revert this applicant to Candidate status?'"
    [paragraph2]="'This will change the applicant status back to Candidate.'" [isOpen]="isRevertModalOpen"
    (close)="closeRevertModal()">
    <button modal-btn-left class="btn btn-lg btn-primary w-100" (click)="confirmRevert()" [disabled]="submitting">
      @if (submitting) {
      <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
      }
      <span>Confirm Revert</span>
    </button>
    <button modal-btn-right class="btn btn-lg btn-outline-dark border-0 w-100" (click)="closeRevertModal()">
      Cancel
    </button>
  </app-popup>

  <!-- If Job Offer Sent, show Accept and Edit Job Offer buttons -->
  @if (isStatus('Job Offer Sent')) {
  <div class="d-flex align-items-center justify-content-between gap-3">
    <button class="btn btn-outline btn-lg w-100" (click)="openEditJobOfferOverlay()"
      [disabled]="submitting || !applicationId" [style.border-color]="'#2C435D'" [style.color]="'#2C435D'">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
        <path fill="currentColor"
          d="m11.4 18.161l7.396-7.396a10.289 10.289 0 0 1-3.326-2.234a10.29 10.29 0 0 1-2.235-3.327L5.839 12.6c-.577.577-.866.866-1.114 1.184a6.556 6.556 0 0 0-.749 1.211c-.173.364-.302.752-.56 1.526l-1.362 4.177a.893.893 0 0 0 1.128 1.128l4.177-1.362c.774-.258 1.162-.387 1.526-.56c.43-.205.836-.456 1.211-.749c.318-.248.607-.537 1.184-1.114m9.448-9.448a3.932 3.932 0 0 0-5.561-5.561l-.887.887l.038.111a8.754 8.754 0 0 0 2.092 3.32a8.754 8.754 0 0 0 3.431 2.13l.887-.887Z" />
      </svg>
      <span>Edit Job Offer</span>
    </button>
    <button class="btn btn-success btn-lg w-100" (click)="acceptJobOffer()" [disabled]="submitting || !applicationId">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
        <path fill="currentColor" fill-rule="evenodd"
          d="M18.144 3.63c-1.17.209-2.748.733-4.961 1.47L8.17 6.77c-1.78.594-3.069 1.025-3.98 1.412c-.952.405-1.29.687-1.4.876a1.88 1.88 0 0 0 0 1.886c.11.189.448.471 1.4.876c.911.387 2.2.818 3.98 1.411l.084.028c.38.126.693.23.967.374l5.323-5.265a.768.768 0 1 1 1.08 1.093l-5.3 5.241c.166.292.278.628.416 1.043l.028.084c.593 1.78 1.024 3.069 1.41 3.98c.406.952.688 1.29.877 1.4a1.88 1.88 0 0 0 1.886 0c.189-.11.471-.448.876-1.4c.387-.911.818-2.2 1.411-3.98l1.67-5.012c.738-2.213 1.262-3.79 1.47-4.96c.21-1.176.05-1.676-.25-1.976s-.8-.46-1.975-.25m-.27-1.512c1.303-.232 2.476-.179 3.331.677c.856.855.909 2.028.677 3.33c-.23 1.295-.792 2.98-1.503 5.112l-1.705 5.115c-.578 1.735-1.027 3.083-1.442 4.058c-.4.94-.844 1.736-1.518 2.128a3.41 3.41 0 0 1-3.43 0c-.674-.392-1.118-1.188-1.518-2.128c-.415-.975-.864-2.323-1.443-4.058l-.012-.038c-.203-.607-.264-.772-.352-.903a1.4 1.4 0 0 0-.37-.37c-.13-.088-.296-.15-.904-.352l-.037-.012c-1.735-.579-3.083-1.028-4.058-1.443c-.94-.4-1.736-.844-2.128-1.518a3.41 3.41 0 0 1 0-3.43c.392-.674 1.188-1.118 2.128-1.518c.975-.415 2.323-.864 4.059-1.442l5.114-1.705c2.133-.711 3.817-1.273 5.112-1.503" />
      </svg>
      <span>Accept</span>
    </button>
  </div>
  }

  <!-- If New Joiner, show Edit Join Date and Add as Employee buttons -->
  @if (isStatus('Accepted') || isStatus('New Joiner')) {
  <div class="d-flex align-items-center justify-content-between gap-3">
    <button class="btn btn-outline btn-lg w-100" (click)="openEditJoinDateOverlay()"
      [disabled]="editJoinDateLoading || !applicationId" [style.border-color]="'#2C435D'" [style.color]="'#2C435D'">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="svg-active-accordion">
        <path d="M16 6a4 4 0 1 1-8 0a4 4 0 0 1 8 0" />
        <path
          d="M14.477 21.92c-.726.053-1.547.08-2.477.08c-8 0-8-2.015-8-4.5S7.582 13 12 13c2.88 0 5.406.856 6.814 2.141C18.298 15 17.574 15 16.5 15c-1.65 0-2.475 0-2.987.513C13 16.025 13 16.85 13 18.5s0 2.475.513 2.987c.237.238.542.365.964.434"
          opacity=".5" />
        <path
          d="M16.5 22c-1.65 0-2.475 0-2.987-.513C13 20.975 13 20.15 13 18.5s0-2.475.513-2.987C14.025 15 14.85 15 16.5 15s2.475 0 2.987.513C20 16.025 20 16.85 20 18.5s0 2.475-.513 2.987C18.975 22 18.15 22 16.5 22m.583-5.056a.583.583 0 1 0-1.166 0v.973h-.973a.583.583 0 1 0 0 1.166h.973v.973a.583.583 0 1 0 1.166 0v-.973h.973a.583.583 0 1 0 0-1.166h-.973z"
          clip-rule="evenodd" />
      </svg>
      <span>Edit Join Date</span>
    </button>
    <button class="btn btn-success btn-lg w-100" (click)="navigateToCreateEmployee()">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24">
        <g fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="12" cy="6" r="4" />
          <path d="M20 22c0-3.866-3.134-7-7-7s-7 3.134-7 7M16 11v6m3-3h-6" />
        </g>
      </svg>
      <span>Add as Employee</span>
    </button>
  </div>
  }

</div>



<!-- Add interview -->
<app-overlay-filter-box #filterBox [title]="overlayTitle">
  <form class="w-100 d-flex flex-column gap-1" (ngSubmit)="submitInterview()">
    <div class="input">
      <label for="title">Interview Title</label>
      <div class="d-flex align-items-center gap-4">
        <div class="form-outline w-100 position-relative">
          @if (interviewDetailsLoading && overlayTitle === 'Reschedule Interview') {
          <div class="placeholder-glow w-100">
            <input type="text" class="form-control placeholder" disabled style="height: 38px;" />
          </div>
          } @else {
          <input type="text" id="title" class="form-control" placeholder="Enter Title" [(ngModel)]="interviewTitle"
            name="title" (input)="onInterviewFormChange()" />
          }
        </div>
      </div>
    </div>
    <div class="input">
      <label for="Department">Department <span class="text-danger">*</span></label>
      <div class="d-flex align-items-center gap-4">
        <div class="form-outline w-100 position-relative custom-date-wrapper">
          @if (departmentsLoading) {
          <div class="placeholder-glow w-100">
            <div class="form-select placeholder w-100" style="height: 38px;"></div>
          </div>
          } @else {
          <select id="Department" class="form-select" [(ngModel)]="department" name="department"
            [class.is-invalid]="validationErrors.department"
            (change)="clearValidationError('department'); onDepartmentChange(); onInterviewFormChange()">
            <option value="" selected disabled hidden>Select Department</option>
            @for (dept of departments; track dept.id) {
            <option [value]="dept.id">{{ dept.name }}</option>
            }
          </select>
          }
        </div>
      </div>
      @if (validationErrors.department) {
      <small class="text-danger mt-1 d-block">{{ validationErrors.department }}</small>
      }
    </div>
    <div class="input">
      <label for="Section">Section <span class="text-danger">*</span></label>
      <div class="d-flex align-items-center gap-4">
        <div class="form-outline w-100 position-relative custom-date-wrapper">
          @if (!department) {
          <select id="Section" class="form-select" [class.is-invalid]="validationErrors.section" disabled>
            <option value="" selected>Please select a department first</option>
          </select>
          } @else if (sectionsLoading) {
          <div class="placeholder-glow w-100">
            <div class="form-select placeholder w-100" style="height: 38px;"></div>
          </div>
          } @else {
          <select id="Section" class="form-select" [(ngModel)]="section" name="section"
            [class.is-invalid]="validationErrors.section"
            (change)="clearValidationError('section'); onSectionChange(); onInterviewFormChange()">
            <option value="" selected disabled hidden>Select Section</option>
            @for (sec of sections; track sec.id) {
            <option [value]="sec.id">{{ sec.name }}</option>
            }
          </select>
          }
        </div>
      </div>
      @if (!department) {
      <small class="text-muted mt-1 d-block">Please select a department first to view available sections</small>
      }
      @if (validationErrors.section) {
      <small class="text-danger mt-1 d-block">{{ validationErrors.section }}</small>
      }
    </div>
    <div class="input">
      <label for="Interviewer">Interviewer <span class="text-danger">*</span></label>
      <div class="d-flex align-items-center gap-4">
        <div class="form-outline w-100 position-relative custom-date-wrapper">
          @if (!section) {
          <select id="Interviewer" class="form-select" disabled>
            <option value="" selected>Please select a section first</option>
          </select>
          } @else if (employeesLoading) {
          <div class="placeholder-glow w-100">
            <div class="form-select placeholder w-100" style="height: 38px;"></div>
          </div>
          } @else if (employees.length === 0) {
          <select id="Interviewer" class="form-select" disabled>
            <option value="" selected>No employees in this section</option>
          </select>
          } @else {
          <select id="Interviewer" class="form-select" [(ngModel)]="interviewer" name="interviewer"
            [class.is-invalid]="validationErrors.interviewer"
            (change)="clearValidationError('interviewer'); onInterviewFormChange()">
            <option value="" selected disabled hidden>Select Interviewer</option>
            @for (emp of employees; track emp.id) {
            <option [value]="emp.id">{{ emp.name }}</option>
            }
          </select>
          }
        </div>
      </div>
      @if (!section) {
      <small class="text-muted mt-1 d-block">Please select a section first to view available employees</small>
      }
      @if (validationErrors.interviewer) {
      <small class="text-danger mt-1 d-block">{{ validationErrors.interviewer }}</small>
      }
    </div>
    <div class="input">
      @if (interviewDetailsLoading && overlayTitle === 'Reschedule Interview') {
      <label class="date-picker-label">Date <span class="text-danger">*</span></label>
      <div class="placeholder-glow w-100">
        <div class="form-control custom-date-input placeholder" style="height: 38px;"></div>
      </div>
      } @else {
      <app-date-picker label="Date" placeholder="Select date" [required]="true" [disableBeforeDate]="true"
        [(ngModel)]="date" name="date" [errorMessage]="validationErrors.date || null"
        (dateChange)="onInterviewDateChange($event)">
      </app-date-picker>
      }
    </div>
    <div class="input">
      <label for="Time">Time <span class="text-danger">*</span></label>
      <div class="d-flex align-items-start justify-content-between gap-3">
        <div class="w-100">
          <div class="form-outline w-100 position-relative custom-date-wrapper">
            @if (interviewDetailsLoading && overlayTitle === 'Reschedule Interview') {
            <div class="placeholder-glow w-100">
              <input type="text" class="form-control custom-date-input placeholder" disabled style="height: 38px;" />
            </div>
            } @else {
            <input type="text" id="TimeFrom" class="form-control custom-date-input"
              [class.is-invalid]="validationErrors.time_from" placeholder="From" [(ngModel)]="time_from"
              name="time_from" pattern="[0-9]{2}:[0-9]{2}" onfocus="this.type='time'"
              (change)="clearValidationError('time_from'); onInterviewFormChange()"
              (input)="clearValidationError('time_from'); onInterviewFormChange()" />
            }
          </div>
          @if (validationErrors.time_from) {
          <small class="text-danger mt-1 d-block">{{ validationErrors.time_from }}</small>
          }
        </div>
        <div class="w-100">
          <div class="form-outline w-100 position-relative custom-date-wrapper">
            @if (interviewDetailsLoading && overlayTitle === 'Reschedule Interview') {
            <div class="placeholder-glow w-100">
              <input type="text" class="form-control custom-date-input placeholder" disabled style="height: 38px;" />
            </div>
            } @else {
            <input type="text" id="TimeTo" class="form-control custom-date-input"
              [class.is-invalid]="validationErrors.time_to" placeholder="To" [(ngModel)]="time_to" name="time_to"
              pattern="[0-9]{2}:[0-9]{2}" onfocus="this.type='time'"
              (change)="clearValidationError('time_to'); onInterviewFormChange()"
              (input)="clearValidationError('time_to'); onInterviewFormChange()" />
            }
          </div>
          @if (validationErrors.time_to) {
          <small class="text-danger mt-1 d-block">{{ validationErrors.time_to }}</small>
          }
        </div>
      </div>
    </div>
    <div class="input mb-1">
      <label for="type">Interview Type <span class="text-danger">*</span></label>
      <div class="d-flex align-items-center justify-content-between gap-3">
        @if (interviewDetailsLoading && overlayTitle === 'Reschedule Interview') {
        <div class="placeholder-glow w-100">
          <div class="d-flex align-items-center gap-2">
            <div class="placeholder" style="width: 20px; height: 20px; border-radius: 50%;"></div>
            <div class="placeholder col-4"></div>
          </div>
        </div>
        <div class="placeholder-glow w-100">
          <div class="d-flex align-items-center gap-2">
            <div class="placeholder" style="width: 20px; height: 20px; border-radius: 50%;"></div>
            <div class="placeholder col-4"></div>
          </div>
        </div>
        } @else {
        <div class="d-flex align-items-center gap-2 w-100">
          <input class="form-check-input radio" type="radio" name="type" id="Online" [checked]="interview_type===2"
            (change)="interview_type=2; onInterviewTypeChange(); onInterviewFormChange()">
          <label for="Online" class="m-0">
            Online
          </label>
        </div>
        <div class="d-flex align-items-center gap-2 w-100">
          <input class="form-check-input radio" type="radio" name="type" id="Offline" [checked]="interview_type===1"
            (change)="interview_type=1; onInterviewTypeChange(); onInterviewFormChange()">
          <label for="Offline" class="m-0">
            Offline
          </label>
        </div>
        }
      </div>
    </div>

    @if (interview_type === 1) {
    <div class="input">
      <label for="Branch">Interview Location <span class="text-danger">*</span></label>
      <div class="d-flex align-items-center gap-4">
        <div class="form-outline w-100 position-relative custom-date-wrapper">
          @if (branchesLoading || (interviewDetailsLoading && overlayTitle === 'Reschedule Interview')) {
          <div class="placeholder-glow w-100">
            <div class="form-select placeholder w-100" style="height: 38px;"></div>
          </div>
          } @else {
          <select id="Branch" class="form-select" [(ngModel)]="location" name="location"
            [class.is-invalid]="validationErrors.location"
            (change)="clearValidationError('location'); onInterviewFormChange()">
            <option value="" selected disabled hidden>Select Branch</option>
            @for (branch of branches; track branch.id) {
            <option [value]="branch.id">{{ branch.name }}</option>
            }
          </select>
          }
        </div>
      </div>
      @if (validationErrors.location) {
      <small class="text-danger mt-1 d-block">{{ validationErrors.location }}</small>
      }
    </div>
    }


    <div class="d-flex flex-column gap-2 mt-2">
      <div class="d-flex align-items-center gap-3">
        <button type="submit" class="btn btn-lg btn-primary w-100"
          [disabled]="submitting || !applicationId || isRescheduleLoading">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g fill="none" stroke-width="1.5">
              <circle cx="12" cy="12" r="10" />
              <path stroke-linecap="round" stroke-linejoin="round" d="m8.5 12.5l2 2l5-5" />
            </g>
          </svg>
          <span>{{ overlayTitle }}</span>
        </button>
        <a class="btn btn-lg btn-outline-dark border-0 w-100" (click)="discardInterviewAndClose()">
          <span>Discard Invitation</span>
        </a>
      </div>
      @if (validationErrors.noChanges) {
      <small class="text-danger text-center w-100">{{ validationErrors.noChanges }}</small>
      }
    </div>

  </form>
</app-overlay-filter-box>


<!-- job offer -->
<app-overlay-filter-box #jobBox
  [title]="overlayTitle === 'Job Offer' || overlayTitle === 'Update Job Offer' ? overlayTitle : 'Job Offer'">
  <form class="w-100 d-flex flex-column gap-3" (ngSubmit)="submitJobOffer()">
    @if (jobOfferDetailsLoading && overlayTitle === 'Update Job Offer') {
    <!-- Skeleton loader for all fields -->
    <div class="input placeholder-glow">
      <div class="form-control placeholder col-12 mb-2" style="height: 38px;"></div>
    </div>
    <div class="input placeholder-glow">
      <div class="form-control placeholder col-6 mb-2" style="height: 38px;"></div>
    </div>
    <div class="input placeholder-glow">
      <div class="form-control placeholder col-12 mb-2" style="height: 38px;"></div>
    </div>
    <div class="input placeholder-glow">
      <div class="form-control placeholder col-6 mb-2" style="height: 38px;"></div>
    </div>
    <div class="input placeholder-glow">
      <div class="form-control placeholder col-12 mb-2" style="height: 38px;"></div>
    </div>
    <div class="input placeholder-glow">
      <div class="form-control placeholder col-12 mb-2" style="height: 38px;"></div>
    </div>
    <div class="input placeholder-glow">
      <div class="form-control placeholder col-12 mb-2" style="height: 38px;"></div>
    </div>
    <div class="d-flex align-items-center gap-3 mt-2">
      <div class="btn btn-lg btn-primary w-100 disabled placeholder"></div>
      <div class="btn btn-lg btn-outline-dark border-0 w-100 disabled placeholder"></div>
    </div>
    } @else {
    <div class="input">
      <label>Email</label>
      <input type="email" class="form-control" [value]="applicant?.email || ''" readonly
        style="width: 100%; border-radius: var(--inputs-corner-default, 16px); border: 1px solid var(--inputs-colors-inactive-outline, #93A7C1); box-shadow: none; padding: var(--inputs-spacing-lg-padding, 16px);">
    </div>
    <div class="input d-flex align-items-center gap-2">
      <input type="checkbox" id="probation" class="form-check-input" [(ngModel)]="includeProbation"
        name="includeProbation">
      <label for="probation" class="m-0">Include Probation Period</label>
    </div>
    <div class="input">
      <app-date-picker label="Join Date" placeholder="dd/mm/yyyy" [(ngModel)]="offerJoinDate" name="joinDate"
        [errorMessage]="jobOfferValidationErrors.joinDate || null" (ngModelChange)="validateJoinDateField()">
      </app-date-picker>
      @if (jobOfferValidationErrors.joinDate) {
      <div class="text-danger mt-1">{{ jobOfferValidationErrors.joinDate }}</div>
      }
    </div>
    <div class="input d-flex align-items-center gap-2">
      <input type="checkbox" id="withEndDate" class="form-check-input" [(ngModel)]="withEndDate" name="withEndDate">
      <label for="withEndDate" class="m-0">With end date</label>
    </div>
    @if (withEndDate){
    <div class="input">
      <label for="contractEndDate">Contract End Date</label>
      <app-date-picker label="Contract End Date" placeholder="Select date" [(ngModel)]="contractEndDate"
        name="contractEndDate">
      </app-date-picker>
    </div>
    }
    <div class="input">
      <label for="noticePeriod">Notice Period (in Days)</label>
      <input type="number" id="noticePeriod" class="form-control" [(ngModel)]="noticePeriod" name="noticePeriod"
        placeholder="Enter number of days" [class.is-invalid]="jobOfferValidationErrors.noticePeriod"
        (focus)="onNoticePeriodFocus()" (blur)="validateNoticePeriodField()"
        style="border-radius: var(--inputs-corner-default, 16px); border: 1px solid var(--inputs-colors-inactive-outline, #93A7C1); box-shadow: none; padding: var(--inputs-spacing-lg-padding, 16px);">
      @if (jobOfferValidationErrors.noticePeriod) {
      <div class="text-danger mt-1">{{ jobOfferValidationErrors.noticePeriod }}</div>
      }
    </div>
    @if (overlayTitle === 'Update Job Offer') {
    <div class="d-flex justify-content-between align-items-center mb-1">
      <span class="text-muted">Min. Salary<br><span class="fw-bold">{{ minSalary | number:'1.0-0' }} EGP</span></span>
      <span class="text-muted">Max. Salary<br><span class="fw-bold">{{ maxSalary | number:'1.0-0' }} EGP</span></span>
    </div>
    }
    <div class="input">
      <label for="salary">Salary</label>
      <input type="text" id="salary" class="form-control" [(ngModel)]="offerSalary" name="salary" placeholder="EGP"
        [class.is-invalid]="jobOfferValidationErrors.salary" (focus)="onSalaryFocus()" (blur)="validateSalaryField()"
        style="border-radius: var(--inputs-corner-default, 16px); border: 1px solid var(--inputs-colors-inactive-outline, #93A7C1); box-shadow: none; padding: var(--inputs-spacing-lg-padding, 16px);">
      @if (jobOfferValidationErrors.salary) {
      <div class="text-danger mt-1">{{ jobOfferValidationErrors.salary }}</div>
      }
    </div>
    <div class="input">
      <label for="offerDetails">Offer Details</label>
      <textarea id="offerDetails" class="form-control" rows="4" [(ngModel)]="offerDetails" name="offerDetails"
        placeholder="Enter Offer Details" [class.is-invalid]="jobOfferValidationErrors.offerDetails"
        (focus)="onOfferDetailsFocus()" (blur)="validateOfferDetailsField()"
        style="border-radius: var(--inputs-corner-default, 16px); border: 1px solid var(--inputs-colors-inactive-outline, #93A7C1); box-shadow: none; padding: var(--inputs-spacing-lg-padding, 16px);"></textarea>
      @if (jobOfferValidationErrors.offerDetails && (jobOfferFormSubmitted)) {
      <div class="text-danger mt-1">{{ jobOfferValidationErrors.offerDetails }}</div>
      }
    </div>
    <div class="d-flex align-items-center gap-3 mt-2">
      <button type="submit" class="btn btn-lg btn-primary w-100" [disabled]="submitting || !applicationId">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
          <g fill="none" stroke-width="1.5">
            <circle cx="12" cy="12" r="10" />
            <path stroke-linecap="round" stroke-linejoin="round" d="m8.5 12.5l2 2l5-5" />
          </g>
        </svg>
        <span>Send Job Offer</span>
      </button>
      <a class="btn btn-lg btn-outline-dark border-0 w-100" (click)="closeAllOverlays()">
        <span>Discard Job Offer</span>
      </a>
    </div>
    }
  </form>
</app-overlay-filter-box>

<!-- Edit join date -->
<app-overlay-filter-box #editJoinDateBox title="Edit Join Date">
  <form class="w-100 d-flex flex-column gap-1" (ngSubmit)="submitEditJoinDate()">
    <div class="input">
      <label for="newJoinDate">New Join Date</label>
      <div class="d-flex align-items-center gap-4">
        <div class="form-outline w-100 position-relative custom-date-wrapper">
          <app-date-picker label="New Join Date" placeholder="Select Join Date" [(ngModel)]="editJoinDateInput"
            name="newJoinDate" [errorMessage]="editJoinDateValidationErrors.joinDate || null"
            (dateChange)="validateEditJoinDateField()">
          </app-date-picker>
        </div>
      </div>
      @if (editJoinDateValidationErrors.joinDate) {
      <small class="text-danger mt-1 d-block">{{ editJoinDateValidationErrors.joinDate }}</small>
      }
    </div>

    <div class="d-flex flex-column gap-2 mt-2">
      <div class="d-flex align-items-center gap-3">
        <button type="submit" class="btn btn-lg btn-primary w-100" [disabled]="editJoinDateLoading || !applicationId">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <g fill="none" stroke-width="1.5">
              <circle cx="12" cy="12" r="10" />
              <path stroke-linecap="round" stroke-linejoin="round" d="m8.5 12.5l2 2l5-5" />
            </g>
          </svg>
          <span>Update Join Date</span>
        </button>
        <a class="btn btn-lg btn-outline-dark border-0 w-100" (click)="editJoinDateBox?.closeOverlay()">
          <span>Cancel</span>
        </a>
      </div>
    </div>
  </form>
</app-overlay-filter-box>